> ============================ Trial for variable06 ontorelView 
min=1 max=1 inc=1
> ============================ Input size : 1
SET
 pg_stat_statements_reset 
--------------------------
 
(1 row)

> Loop number : 1
SET
SET
SET
SET
SET
SET
SET
SET
SET
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Hash Left Join  (cost=18887920.23..18895699.77 rows=343004 width=72) (actual time=15044.383..15493.414 rows=311122 loops=1)
   Hash Cond: ((patient_hospitalisation_debut_fin.hospitalisation)::uuid = (nombre_semaines.hospitalisation)::uuid)
   Buffers: shared hit=10910 read=190193, temp read=245698 written=247997
   I/O Timings: shared read=14700.185, temp read=953.754 write=3154.232
   CTE patient_hospitalisation_debut_fin
     ->  Unique  (cost=637337.74..682502.73 rows=343004 width=48) (actual time=12849.353..13476.246 rows=311122 loops=1)
           Buffers: shared hit=10910 read=190193, temp read=228851 written=229931
           I/O Timings: shared read=14700.185, temp read=889.977 write=2970.196
           ->  Gather Merge  (cost=637337.74..679072.69 rows=343004 width=48) (actual time=12849.352..13406.583 rows=592238 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 Buffers: shared hit=10910 read=190193, temp read=228851 written=229931
                 I/O Timings: shared read=14700.185, temp read=889.977 write=2970.196
                 ->  Unique  (cost=636337.72..638481.49 rows=171502 width=48) (actual time=12819.814..12932.117 rows=197413 loops=3)
                       Buffers: shared hit=10910 read=190193, temp read=228851 written=229931
                       I/O Timings: shared read=14700.185, temp read=889.977 write=2970.196
                       ->  Sort  (cost=636337.72..636766.47 rows=171502 width=48) (actual time=12819.812..12887.550 rows=294355 loops=3)
                             Sort Key: "T2448628400"."T2448628400_uid", "Tfa45026200"."Tfa45026200_uid", "Tcee93e6b00"."Tcee93e6b00_Ontorel-Core_0000004", "Td270e16c00"."Td270e16c00_Ontorel-Core_0000004"
                             Sort Method: external merge  Disk: 16768kB
                             Buffers: shared hit=10910 read=190193, temp read=228851 written=229931
                             I/O Timings: shared read=14700.185, temp read=889.977 write=2970.196
                             Worker 0:  Sort Method: external merge  Disk: 16712kB
                             Worker 1:  Sort Method: external merge  Disk: 16672kB
                             ->  Parallel Hash Join  (cost=577178.76..616149.45 rows=171502 width=48) (actual time=12171.373..12640.710 rows=294355 loops=3)
                                   Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("T2448628400"."T2448628400_uid")::uuid)
                                   Buffers: shared hit=10782 read=190193, temp read=222582 written=223644
                                   I/O Timings: shared read=14700.185, temp read=867.866 write=2893.602
                                   ->  Parallel Hash Join  (cost=571590.98..610111.47 rows=171502 width=64) (actual time=10733.302..11080.983 rows=294355 loops=3)
                                         Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("Tfa45062900"."Tfa45062900_uid")::uuid)
                                         Buffers: shared hit=9145 read=190193, temp read=222582 written=223644
                                         I/O Timings: shared read=14700.185, temp read=867.866 write=2893.602
                                         ->  Parallel Hash Join  (cost=566003.21..604073.49 rows=171502 width=48) (actual time=10686.832..10912.527 rows=294355 loops=3)
                                               Hash Cond: (("Tc68c9cba00"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                               Buffers: shared hit=7524 read=190193, temp read=222582 written=223644
                                               I/O Timings: shared read=14700.185, temp read=867.866 write=2893.602
                                               ->  Parallel Seq Scan on "Tc68c9cba00"  (cost=0.00..21784.05 rows=787905 width=32) (actual time=0.077..163.163 rows=630324 loops=3)
                                                     Buffers: shared hit=410 read=13495
                                                     I/O Timings: shared read=307.796
                                               ->  Parallel Hash  (cost=562016.44..562016.44 rows=171502 width=64) (actual time=10353.489..10353.535 rows=294355 loops=3)
                                                     Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 6272kB
                                                     Buffers: shared hit=7114 read=176698, temp read=202047 written=211544
                                                     I/O Timings: shared read=14392.389, temp read=786.775 write=2740.145
                                                     ->  Parallel Hash Join  (cost=531042.15..562016.44 rows=171502 width=64) (actual time=10050.946..10219.045 rows=294355 loops=3)
                                                           Hash Cond: (("Tfa45020700"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                                           Buffers: shared hit=7114 read=176698, temp read=198440 written=199396
                                                           I/O Timings: shared read=14392.389, temp read=774.325 write=2594.051
                                                           ->  Parallel Seq Scan on "Tfa45020700"  (cost=0.00..18101.05 rows=787905 width=16) (actual time=0.037..127.287 rows=630324 loops=3)
                                                                 Buffers: shared hit=414 read=9808
                                                                 I/O Timings: shared read=232.941
                                                           ->  Parallel Hash  (cost=527390.38..527390.38 rows=171502 width=48) (actual time=9805.037..9805.079 rows=294355 loops=3)
                                                                 Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 5408kB
                                                                 Buffers: shared hit=6700 read=166890, temp read=183189 written=190984
                                                                 I/O Timings: shared read=14159.448, temp read=714.656 write=2489.390
                                                                 ->  Parallel Hash Join  (cost=481032.46..527390.38 rows=171502 width=48) (actual time=9488.621..9634.391 rows=294355 loops=3)
                                                                       Hash Cond: (("T69af2e7200"."Tfa45022500_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                       Buffers: shared hit=6700 read=166890, temp read=177131 written=177932
                                                                       I/O Timings: shared read=14159.448, temp read=689.281 write=2304.100
                                                                       ->  Parallel Seq Scan on "T69af2e7200"  (cost=0.00..26988.69 rows=976169 width=32) (actual time=0.037..116.463 rows=780935 loops=3)
                                                                             Buffers: shared hit=399 read=16828
                                                                             I/O Timings: shared read=152.651
                                                                       ->  Parallel Hash  (cost=477766.04..477766.04 rows=129634 width=80) (actual time=9195.164..9195.203 rows=103707 loops=3)
                                                                             Buckets: 131072  Batches: 8  Memory Usage: 5344kB
                                                                             Buffers: shared hit=6301 read=150062, temp read=158906 written=163004
                                                                             I/O Timings: shared read=14006.797, temp read=617.744 write=2120.191
                                                                             ->  Parallel Hash Join  (cost=445126.33..477766.04 rows=129634 width=80) (actual time=9048.875..9151.990 rows=103707 loops=3)
                                                                                   Hash Cond: (("Tcee93e6b00"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                   Buffers: shared hit=6301 read=150062, temp read=158906 written=159632
                                                                                   I/O Timings: shared read=14006.797, temp read=617.744 write=2077.889
                                                                                   ->  Parallel Seq Scan on "Tcee93e6b00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.038..287.217 rows=590288 loops=3)
                                                                                         Buffers: shared hit=1108 read=10172
                                                                                         I/O Timings: shared read=714.008
                                                                                   ->  Parallel Hash  (cost=441479.90..441479.90 rows=129634 width=104) (actual time=8629.398..8629.434 rows=103707 loops=3)
                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5728kB
                                                                                         Buffers: shared hit=5193 read=139890, temp read=145238 written=150072
                                                                                         I/O Timings: shared read=13292.789, temp read=564.651 write=1953.511
                                                                                         ->  Parallel Hash Join  (cost=412242.19..441479.90 rows=129634 width=104) (actual time=8490.225..8583.177 rows=103707 loops=3)
                                                                                               Hash Cond: (("T5b22144800"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                               Buffers: shared hit=5193 read=139890, temp read=145238 written=145924
                                                                                               I/O Timings: shared read=13292.789, temp read=564.651 write=1903.540
                                                                                               ->  Parallel Seq Scan on "T5b22144800"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.034..210.795 rows=590288 loops=3)
                                                                                                     Buffers: shared hit=429 read=9144
                                                                                                     I/O Timings: shared read=489.636
                                                                                               ->  Parallel Hash  (cost=408848.76..408848.76 rows=129634 width=88) (actual time=8153.410..8153.444 rows=103707 loops=3)
                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5120kB
                                                                                                     Buffers: shared hit=4764 read=130746, temp read=133834 written=138084
                                                                                                     I/O Timings: shared read=12803.153, temp read=518.763 write=1802.559
                                                                                                     ->  Parallel Hash Join  (cost=373027.05..408848.76 rows=129634 width=88) (actual time=7998.205..8108.560 rows=103707 loops=3)
                                                                                                           Hash Cond: (("Tbe02328700"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                           Buffers: shared hit=4764 read=130746, temp read=133834 written=134444
                                                                                                           I/O Timings: shared read=12803.153, temp read=518.763 write=1756.154
                                                                                                           ->  Parallel Seq Scan on "Tbe02328700"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.068..278.913 rows=590288 loops=3)
                                                                                                                 Buffers: shared hit=453 read=12569
                                                                                                                 I/O Timings: shared read=662.458
                                                                                                           ->  Parallel Hash  (cost=369380.63..369380.63 rows=129634 width=104) (actual time=7561.198..7561.229 rows=103707 loops=3)
                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5760kB
                                                                                                                 Buffers: shared hit=4311 read=118177, temp read=118445 written=123156
                                                                                                                 I/O Timings: shared read=12140.695, temp read=458.050 write=1606.609
                                                                                                                 ->  Parallel Hash Join  (cost=340142.92..369380.63 rows=129634 width=104) (actual time=7407.409..7514.230 rows=103707 loops=3)
                                                                                                                       Hash Cond: (("Tfa4502a400"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                                       Buffers: shared hit=4311 read=118177, temp read=118445 written=119008
                                                                                                                       I/O Timings: shared read=12140.695, temp read=458.050 write=1555.496
                                                                                                                       ->  Parallel Seq Scan on "Tfa4502a400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.055..224.950 rows=590288 loops=3)
                                                                                                                             Buffers: shared hit=390 read=9183
                                                                                                                             I/O Timings: shared read=529.756
                                                                                                                       ->  Parallel Hash  (cost=336749.49..336749.49 rows=129634 width=88) (actual time=7067.723..7067.752 rows=103707 loops=3)
                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 5152kB
                                                                                                                             Buffers: shared hit=3921 read=108994, temp read=107043 written=111164
                                                                                                                             I/O Timings: shared read=11610.939, temp read=413.747 write=1451.897
                                                                                                                             ->  Parallel Hash Join  (cost=303982.78..336749.49 rows=129634 width=88) (actual time=6917.056..7023.186 rows=103707 loops=3)
                                                                                                                                   Hash Cond: (("Td270e16c00"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                   Buffers: shared hit=3921 read=108994, temp read=107043 written=107540
                                                                                                                                   I/O Timings: shared read=11610.939, temp read=413.747 write=1406.197
                                                                                                                                   ->  Parallel Seq Scan on "Td270e16c00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.034..569.914 rows=590288 loops=3)
                                                                                                                                         Buffers: shared hit=319 read=10961
                                                                                                                                         I/O Timings: shared read=1564.757
                                                                                                                                   ->  Parallel Hash  (cost=300209.36..300209.36 rows=129634 width=112) (actual time=6224.747..6224.773 rows=103707 loops=3)
                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 6080kB
                                                                                                                                         Buffers: shared hit=3602 read=98033, temp read=93113 written=97972
                                                                                                                                         I/O Timings: shared read=10046.182, temp read=360.161 write=1284.385
                                                                                                                                         ->  Parallel Hash Join  (cost=270845.65..300209.36 rows=129634 width=112) (actual time=6074.716..6177.074 rows=103707 loops=3)
                                                                                                                                               Hash Cond: (("T5b22144900"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                               Buffers: shared hit=3602 read=98033, temp read=93113 written=93560
                                                                                                                                               I/O Timings: shared read=10046.182, temp read=360.161 write=1229.916
                                                                                                                                               ->  Parallel Seq Scan on "T5b22144900"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.034..501.430 rows=590288 loops=3)
                                                                                                                                                     Buffers: shared hit=288 read=9285
                                                                                                                                                     I/O Timings: shared read=1354.697
                                                                                                                                               ->  Parallel Hash  (cost=267326.22..267326.22 rows=129634 width=96) (actual time=5461.528..5461.552 rows=103707 loops=3)
                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5472kB
                                                                                                                                                     Buffers: shared hit=3314 read=88748, temp read=81443 written=85724
                                                                                                                                                     I/O Timings: shared read=8691.485, temp read=315.046 write=1128.089
                                                                                                                                                     ->  Parallel Hash Join  (cost=231124.51..267326.22 rows=129634 width=96) (actual time=5302.495..5415.285 rows=103707 loops=3)
                                                                                                                                                           Hash Cond: (("T5b5e0b4000"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                           Buffers: shared hit=3314 read=88748, temp read=81443 written=81820
                                                                                                                                                           I/O Timings: shared read=8691.485, temp read=315.046 write=1078.054
                                                                                                                                                           ->  Parallel Seq Scan on "T5b5e0b4000"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.066..477.144 rows=590288 loops=3)
                                                                                                                                                                 Buffers: shared hit=288 read=12734
                                                                                                                                                                 I/O Timings: shared read=1255.481
                                                                                                                                                           ->  Parallel Hash  (cost=227098.09..227098.09 rows=129634 width=128) (actual time=4663.968..4663.990 rows=103707 loops=3)
                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 6656kB
                                                                                                                                                                 Buffers: shared hit=3026 read=76014, temp read=65253 written=70536
                                                                                                                                                                 I/O Timings: shared read=7436.004, temp read=252.166 write=924.414
                                                                                                                                                                 ->  Parallel Hash Join  (cost=197480.37..227098.09 rows=129634 width=128) (actual time=4507.000..4612.191 rows=103707 loops=3)
                                                                                                                                                                       Hash Cond: (("Tfa4505c500"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                       Buffers: shared hit=3026 read=76014, temp read=65253 written=65580
                                                                                                                                                                       I/O Timings: shared read=7436.004, temp read=252.166 write=863.659
                                                                                                                                                                       ->  Parallel Seq Scan on "Tfa4505c500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.045..235.642 rows=590288 loops=3)
                                                                                                                                                                             Buffers: shared hit=192 read=9381
                                                                                                                                                                             I/O Timings: shared read=561.650
                                                                                                                                                                       ->  Parallel Hash  (cost=193706.95..193706.95 rows=129634 width=112) (actual time=4155.555..4155.574 rows=103707 loops=3)
                                                                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                             Buffers: shared hit=2834 read=66633, temp read=53054 written=57752
                                                                                                                                                                             I/O Timings: shared read=6874.353, temp read=205.339 write=756.166
                                                                                                                                                                             ->  Parallel Hash Join  (cost=164343.24..193706.95 rows=129634 width=112) (actual time=4010.043..4105.316 rows=103707 loops=3)
                                                                                                                                                                                   Hash Cond: (("Tfa45022400"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                   Buffers: shared hit=2834 read=66633, temp read=53054 written=53316
                                                                                                                                                                                   I/O Timings: shared read=6874.353, temp read=205.339 write=700.573
                                                                                                                                                                                   ->  Parallel Seq Scan on "Tfa45022400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.034..265.339 rows=590288 loops=3)
                                                                                                                                                                                         Buffers: shared hit=192 read=9381
                                                                                                                                                                                         I/O Timings: shared read=657.257
                                                                                                                                                                                   ->  Parallel Hash  (cost=160823.81..160823.81 rows=129634 width=96) (actual time=3624.415..3624.430 rows=103707 loops=3)
                                                                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                         Buffers: shared hit=2642 read=57252, temp read=41386 written=45496
                                                                                                                                                                                         I/O Timings: shared read=6217.096, temp read=160.106 write=598.489
                                                                                                                                                                                         ->  Parallel Hash Join  (cost=124875.10..160823.81 rows=129634 width=96) (actual time=3471.110..3579.472 rows=103707 loops=3)
                                                                                                                                                                                               Hash Cond: (("Tedb9668900"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                               Buffers: shared hit=2642 read=57252, temp read=41386 written=41588
                                                                                                                                                                                               I/O Timings: shared read=6217.096, temp read=160.106 write=548.904
                                                                                                                                                                                               ->  Parallel Seq Scan on "Tedb9668900"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.064..843.499 rows=590288 loops=3)
                                                                                                                                                                                                     Buffers: shared hit=192 read=12830
                                                                                                                                                                                                     I/O Timings: shared read=2358.718
                                                                                                                                                                                               ->  Parallel Hash  (cost=121101.68..121101.68 rows=129634 width=112) (actual time=2471.362..2471.375 rows=103707 loops=3)
                                                                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                                                     Buffers: shared hit=2450 read=44422, temp read=25731 written=30304
                                                                                                                                                                                                     I/O Timings: shared read=3858.378, temp read=100.502 write=399.197
                                                                                                                                                                                                     ->  Parallel Hash Join  (cost=91737.97..121101.68 rows=129634 width=112) (actual time=2322.871..2424.107 rows=103707 loops=3)
                                                                                                                                                                                                           Hash Cond: (("Tfa4502a500"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                                           Buffers: shared hit=2450 read=44422, temp read=25731 written=25880
                                                                                                                                                                                                           I/O Timings: shared read=3858.378, temp read=100.502 write=345.120
                                                                                                                                                                                                           ->  Parallel Seq Scan on "Tfa4502a500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.037..461.655 rows=590288 loops=3)
                                                                                                                                                                                                                 Buffers: shared hit=192 read=9381
                                                                                                                                                                                                                 I/O Timings: shared read=1244.117
                                                                                                                                                                                                           ->  Parallel Hash  (cost=88218.54..88218.54 rows=129634 width=96) (actual time=1751.058..1751.068 rows=103707 loops=3)
                                                                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                                                 Buffers: shared hit=2258 read=35041, temp read=14058 written=18048
                                                                                                                                                                                                                 I/O Timings: shared read=2614.261, temp read=55.391 write=241.184
                                                                                                                                                                                                                 ->  Parallel Hash Join  (cost=53029.83..88218.54 rows=129634 width=96) (actual time=1607.818..1706.051 rows=103707 loops=3)
                                                                                                                                                                                                                       Hash Cond: (("Tc9e51c8100"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                                                                       Buffers: shared hit=2258 read=35041, temp read=14058 written=14136
                                                                                                                                                                                                                       I/O Timings: shared read=2614.261, temp read=55.391 write=191.857
                                                                                                                                                                                                                       ->  Parallel Seq Scan on "Tc9e51c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.070..564.465 rows=590288 loops=3)
                                                                                                                                                                                                                             Buffers: shared hit=192 read=12830
                                                                                                                                                                                                                             I/O Timings: shared read=1518.998
                                                                                                                                                                                                                       ->  Parallel Hash  (cost=50016.41..50016.41 rows=129634 width=64) (actual time=882.515..882.522 rows=103707 loops=3)
                                                                                                                                                                                                                             Buckets: 131072  Batches: 8  Memory Usage: 4704kB
                                                                                                                                                                                                                             Buffers: shared hit=2066 read=22211, temp written=2844
                                                                                                                                                                                                                             I/O Timings: shared read=1095.263, temp write=39.155
                                                                                                                                                                                                                             ->  Parallel Hash Join  (cost=26308.70..50016.41 rows=129634 width=64) (actual time=368.316..841.880 rows=103707 loops=3)
                                                                                                                                                                                                                                   Hash Cond: (("T528b9c8100"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                                                                   Buffers: shared hit=2066 read=22211
                                                                                                                                                                                                                                   I/O Timings: shared read=1095.263
                                                                                                                                                                                                                                   ->  Parallel Seq Scan on "T528b9c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.038..312.543 rows=590288 loops=3)
                                                                                                                                                                                                                                         Buffers: shared hit=192 read=12830
                                                                                                                                                                                                                                         I/O Timings: shared read=782.196
                                                                                                                                                                                                                                   ->  Parallel Hash  (cost=24688.27..24688.27 rows=129634 width=32) (actual time=365.106..365.111 rows=103707 loops=3)
                                                                                                                                                                                                                                         Buckets: 524288  Batches: 1  Memory Usage: 23648kB
                                                                                                                                                                                                                                         Buffers: shared hit=1874 read=9381
                                                                                                                                                                                                                                         I/O Timings: shared read=313.067
                                                                                                                                                                                                                                         ->  Parallel Hash Join  (cost=5799.79..24688.27 rows=129634 width=32) (actual time=265.474..324.927 rows=103707 loops=3)
                                                                                                                                                                                                                                               Hash Cond: (("Tfa45022500"."Tfa45022500_uid")::uuid = ("Tfa45026200"."Tfa45026200_uid")::uuid)
                                                                                                                                                                                                                                               Buffers: shared hit=1874 read=9381
                                                                                                                                                                                                                                               I/O Timings: shared read=313.067
                                                                                                                                                                                                                                               ->  Parallel Seq Scan on "Tfa45022500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.044..151.522 rows=590288 loops=3)
                                                                                                                                                                                                                                                     Buffers: shared hit=192 read=9381
                                                                                                                                                                                                                                                     I/O Timings: shared read=313.067
                                                                                                                                                                                                                                               ->  Parallel Hash  (cost=3512.13..3512.13 rows=183013 width=16) (actual time=47.187..47.188 rows=103707 loops=3)
                                                                                                                                                                                                                                                     Buckets: 524288  Batches: 1  Memory Usage: 18720kB
                                                                                                                                                                                                                                                     Buffers: shared hit=1682
                                                                                                                                                                                                                                                     ->  Parallel Seq Scan on "Tfa45026200"  (cost=0.00..3512.13 rows=183013 width=16) (actual time=0.010..9.219 rows=103707 loops=3)
                                                                                                                                                                                                                                                           Buffers: shared hit=1682
                                         ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=45.340..45.341 rows=99904 loops=3)
                                               Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                               Buffers: shared hit=1621
                                               ->  Parallel Seq Scan on "Tfa45062900"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.015..9.548 rows=99904 loops=3)
                                                     Buffers: shared hit=1621
                                   ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=1436.216..1436.217 rows=99904 loops=3)
                                         Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                         Buffers: shared hit=1621
                                         ->  Parallel Seq Scan on "T2448628400"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.007..9.447 rows=99904 loops=3)
                                               Buffers: shared hit=1621
   ->  CTE Scan on patient_hospitalisation_debut_fin  (cost=0.00..6860.08 rows=343004 width=40) (actual time=12849.356..12892.050 rows=311122 loops=1)
         Buffers: shared hit=2969 read=62728, temp read=76362 written=77262
         I/O Timings: shared read=4884.518, temp read=298.075 write=992.123
   ->  Hash  (cost=18205415.00..18205415.00 rows=200 width=48) (actual time=2194.969..2194.975 rows=166997 loops=1)
         Buckets: 262144 (originally 1024)  Batches: 2 (originally 1)  Memory Usage: 6617kB
         Buffers: temp read=14551 written=16772
         I/O Timings: temp read=53.228 write=168.554
         ->  Subquery Scan on nombre_semaines  (cost=18205409.50..18205415.00 rows=200 width=48) (actual time=1636.270..2151.778 rows=166997 loops=1)
               Buffers: temp read=14551 written=16367
               I/O Timings: temp read=53.228 write=163.517
               ->  HashAggregate  (cost=18205409.50..18205413.00 rows=200 width=48) (actual time=1636.259..2133.663 rows=166997 loops=1)
                     Group Key: curr.hospitalisation
                     Batches: 21  Memory Usage: 8265kB  Disk Usage: 36648kB
                     Buffers: temp read=14551 written=16367
                     I/O Timings: temp read=53.228 write=163.517
                     ->  Merge Join  (cost=96723.78..11864470.71 rows=195105809 width=40) (actual time=674.097..1160.467 rows=703895 loops=1)
                           Merge Cond: ((curr.patient)::uuid = (prev.patient)::uuid)
                           Join Filter: (((curr.hospitalisation)::uuid <> (prev.hospitalisation)::uuid) AND ((prev.date_admission_hospitalisation)::timestamp without time zone <= (curr.date_admission_hospitalisation)::timestamp without time zone))
                           Rows Removed by Join Filter: 1015015
                           Buffers: temp read=7923 written=6330
                           I/O Timings: temp read=28.511 write=74.722
                           ->  Sort  (cost=47775.64..48633.15 rows=343004 width=40) (actual time=532.313..575.121 rows=311122 loops=1)
                                 Sort Key: curr.patient
                                 Sort Method: external merge  Disk: 15240kB
                                 Buffers: temp read=3511 written=4113
                                 I/O Timings: temp read=12.658 write=49.268
                                 ->  CTE Scan on patient_hospitalisation_debut_fin curr  (cost=0.00..6860.08 rows=343004 width=40) (actual time=0.023..437.623 rows=311122 loops=1)
                                       Buffers: temp read=1606 written=2202
                                       I/O Timings: temp read=5.556 write=27.117
                           ->  Materialize  (cost=48948.14..50663.16 rows=343004 width=48) (actual time=141.703..307.820 rows=1718910 loops=1)
                                 Buffers: temp read=4412 written=2217
                                 I/O Timings: temp read=15.853 write=25.454
                                 ->  Sort  (cost=48948.14..49805.65 rows=343004 width=48) (actual time=141.699..185.860 rows=311122 loops=1)
                                       Sort Key: prev.patient
                                       Sort Method: external merge  Disk: 17672kB
                                       Buffers: temp read=4412 written=2217
                                       I/O Timings: temp read=15.853 write=25.454
                                       ->  CTE Scan on patient_hospitalisation_debut_fin prev  (cost=0.00..6860.08 rows=343004 width=48) (actual time=0.040..47.016 rows=311122 loops=1)
                                             Buffers: temp read=2203 written=1
                                             I/O Timings: temp read=7.802 write=0.028
 Settings: search_path = 'test_mimic'
 Planning:
   Buffers: shared hit=1113
 Planning Time: 29.837 ms
 JIT:
   Functions: 524
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 26.107 ms, Inlining 270.296 ms, Optimization 2126.465 ms, Emission 1465.444 ms, Total 3888.312 ms
 Execution Time: 15558.236 ms
(278 rows)

> Loop number : 2
SET
SET
SET
SET
SET
SET
SET
SET
SET
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Hash Left Join  (cost=18887920.23..18895699.77 rows=343004 width=72) (actual time=14104.690..14588.644 rows=311122 loops=1)
   Hash Cond: ((patient_hospitalisation_debut_fin.hospitalisation)::uuid = (nombre_semaines.hospitalisation)::uuid)
   Buffers: shared hit=11375 read=189728, temp read=245754 written=248120
   I/O Timings: shared read=11773.808, temp read=969.159 write=3204.725
   CTE patient_hospitalisation_debut_fin
     ->  Unique  (cost=637337.74..682502.73 rows=343004 width=48) (actual time=11894.260..12550.292 rows=311122 loops=1)
           Buffers: shared hit=11375 read=189728, temp read=228907 written=230054
           I/O Timings: shared read=11773.808, temp read=905.543 write=3016.857
           ->  Gather Merge  (cost=637337.74..679072.69 rows=343004 width=48) (actual time=11894.259..12481.353 rows=592079 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 Buffers: shared hit=11375 read=189728, temp read=228907 written=230054
                 I/O Timings: shared read=11773.808, temp read=905.543 write=3016.857
                 ->  Unique  (cost=636337.72..638481.49 rows=171502 width=48) (actual time=11863.516..11972.736 rows=197360 loops=3)
                       Buffers: shared hit=11375 read=189728, temp read=228907 written=230054
                       I/O Timings: shared read=11773.808, temp read=905.543 write=3016.857
                       ->  Sort  (cost=636337.72..636766.47 rows=171502 width=48) (actual time=11863.514..11929.211 rows=294355 loops=3)
                             Sort Key: "T2448628400"."T2448628400_uid", "Tfa45026200"."Tfa45026200_uid", "Tcee93e6b00"."Tcee93e6b00_Ontorel-Core_0000004", "Td270e16c00"."Td270e16c00_Ontorel-Core_0000004"
                             Sort Method: external merge  Disk: 16608kB
                             Buffers: shared hit=11375 read=189728, temp read=228907 written=230054
                             I/O Timings: shared read=11773.808, temp read=905.543 write=3016.857
                             Worker 0:  Sort Method: external merge  Disk: 16792kB
                             Worker 1:  Sort Method: external merge  Disk: 16744kB
                             ->  Parallel Hash Join  (cost=577178.76..616149.45 rows=171502 width=48) (actual time=11205.390..11673.078 rows=294355 loops=3)
                                   Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("T2448628400"."T2448628400_uid")::uuid)
                                   Buffers: shared hit=11247 read=189728, temp read=222639 written=223768
                                   I/O Timings: shared read=11773.808, temp read=883.726 write=2940.657
                                   ->  Parallel Hash Join  (cost=571590.98..610111.47 rows=171502 width=64) (actual time=9795.497..10135.846 rows=294355 loops=3)
                                         Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("Tfa45062900"."Tfa45062900_uid")::uuid)
                                         Buffers: shared hit=9610 read=189728, temp read=222639 written=223768
                                         I/O Timings: shared read=11773.808, temp read=883.726 write=2940.657
                                         ->  Parallel Hash Join  (cost=566003.21..604073.49 rows=171502 width=48) (actual time=9748.898..9970.152 rows=294355 loops=3)
                                               Hash Cond: (("Tc68c9cba00"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                               Buffers: shared hit=7989 read=189728, temp read=222639 written=223768
                                               I/O Timings: shared read=11773.808, temp read=883.726 write=2940.657
                                               ->  Parallel Seq Scan on "Tc68c9cba00"  (cost=0.00..21784.05 rows=787905 width=32) (actual time=0.079..499.274 rows=630324 loops=3)
                                                     Buffers: shared hit=288 read=13617
                                                     I/O Timings: shared read=1309.427
                                               ->  Parallel Hash  (cost=562016.44..562016.44 rows=171502 width=64) (actual time=9072.762..9072.818 rows=294355 loops=3)
                                                     Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 6272kB
                                                     Buffers: shared hit=7701 read=176111, temp read=202109 written=211664
                                                     I/O Timings: shared read=10464.381, temp read=801.719 write=2773.694
                                                     ->  Parallel Hash Join  (cost=531042.15..562016.44 rows=171502 width=64) (actual time=8751.047..8932.757 rows=294355 loops=3)
                                                           Hash Cond: (("Tfa45020700"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                                           Buffers: shared hit=7701 read=176111, temp read=198414 written=199424
                                                           I/O Timings: shared read=10464.381, temp read=788.624 write=2620.964
                                                           ->  Parallel Seq Scan on "Tfa45020700"  (cost=0.00..18101.05 rows=787905 width=16) (actual time=0.037..266.564 rows=630324 loops=3)
                                                                 Buffers: shared hit=326 read=9896
                                                                 I/O Timings: shared read=639.890
                                                           ->  Parallel Hash  (cost=527390.38..527390.38 rows=171502 width=48) (actual time=8355.676..8355.729 rows=294355 loops=3)
                                                                 Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 5408kB
                                                                 Buffers: shared hit=7375 read=166215, temp read=183168 written=191008
                                                                 I/O Timings: shared read=9824.491, temp read=723.303 write=2508.339
                                                                 ->  Parallel Hash Join  (cost=481032.46..527390.38 rows=171502 width=48) (actual time=8047.389..8195.407 rows=294355 loops=3)
                                                                       Hash Cond: (("T69af2e7200"."Tfa45022500_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                       Buffers: shared hit=7375 read=166215, temp read=177124 written=177940
                                                                       I/O Timings: shared read=9824.491, temp read=698.921 write=2333.731
                                                                       ->  Parallel Seq Scan on "T69af2e7200"  (cost=0.00..26988.69 rows=976169 width=32) (actual time=0.036..433.007 rows=780935 loops=3)
                                                                             Buffers: shared hit=384 read=16843
                                                                             I/O Timings: shared read=1108.552
                                                                       ->  Parallel Hash  (cost=477766.04..477766.04 rows=129634 width=80) (actual time=7437.131..7437.181 rows=103707 loops=3)
                                                                             Buckets: 131072  Batches: 8  Memory Usage: 5344kB
                                                                             Buffers: shared hit=6991 read=149372, temp read=158903 written=163024
                                                                             I/O Timings: shared read=8715.939, temp read=625.590 write=2134.708
                                                                             ->  Parallel Hash Join  (cost=445126.33..477766.04 rows=129634 width=80) (actual time=7292.815..7393.401 rows=103707 loops=3)
                                                                                   Hash Cond: (("Tcee93e6b00"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                   Buffers: shared hit=6991 read=149372, temp read=158903 written=159656
                                                                                   I/O Timings: shared read=8715.939, temp read=625.590 write=2092.165
                                                                                   ->  Parallel Seq Scan on "Tcee93e6b00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.038..206.830 rows=590288 loops=3)
                                                                                         Buffers: shared hit=968 read=10312
                                                                                         I/O Timings: shared read=472.418
                                                                                   ->  Parallel Hash  (cost=441479.90..441479.90 rows=129634 width=104) (actual time=6949.068..6949.115 rows=103707 loops=3)
                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5728kB
                                                                                         Buffers: shared hit=6023 read=139060, temp read=145239 written=150092
                                                                                         I/O Timings: shared read=8243.521, temp read=572.135 write=1961.639
                                                                                         ->  Parallel Hash Join  (cost=412242.19..441479.90 rows=129634 width=104) (actual time=6805.733..6901.979 rows=103707 loops=3)
                                                                                               Hash Cond: (("T5b22144800"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                               Buffers: shared hit=6023 read=139060, temp read=145239 written=145944
                                                                                               I/O Timings: shared read=8243.521, temp read=572.135 write=1909.018
                                                                                               ->  Parallel Seq Scan on "T5b22144800"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.048..199.350 rows=590288 loops=3)
                                                                                                     Buffers: shared hit=384 read=9189
                                                                                                     I/O Timings: shared read=453.947
                                                                                               ->  Parallel Hash  (cost=408848.76..408848.76 rows=129634 width=88) (actual time=6476.611..6476.656 rows=103707 loops=3)
                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5120kB
                                                                                                     Buffers: shared hit=5639 read=129871, temp read=133836 written=138112
                                                                                                     I/O Timings: shared read=7789.575, temp read=526.804 write=1799.779
                                                                                                     ->  Parallel Hash Join  (cost=373027.05..408848.76 rows=129634 width=88) (actual time=6319.530..6431.961 rows=103707 loops=3)
                                                                                                           Hash Cond: (("Tbe02328700"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                           Buffers: shared hit=5639 read=129871, temp read=133836 written=134472
                                                                                                           I/O Timings: shared read=7789.575, temp read=526.804 write=1752.699
                                                                                                           ->  Parallel Seq Scan on "Tbe02328700"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.072..176.154 rows=590288 loops=3)
                                                                                                                 Buffers: shared hit=405 read=12617
                                                                                                                 I/O Timings: shared read=354.258
                                                                                                           ->  Parallel Hash  (cost=369380.63..369380.63 rows=129634 width=104) (actual time=5988.134..5988.177 rows=103707 loops=3)
                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5760kB
                                                                                                                 Buffers: shared hit=5234 read=117254, temp read=118449 written=123184
                                                                                                                 I/O Timings: shared read=7435.316, temp read=465.376 write=1604.229
                                                                                                                 ->  Parallel Hash Join  (cost=340142.92..369380.63 rows=129634 width=104) (actual time=5834.252..5940.954 rows=103707 loops=3)
                                                                                                                       Hash Cond: (("Tfa4502a400"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                                       Buffers: shared hit=5234 read=117254, temp read=118449 written=119036
                                                                                                                       I/O Timings: shared read=7435.316, temp read=465.376 write=1553.339
                                                                                                                       ->  Parallel Seq Scan on "Tfa4502a400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.202..139.973 rows=590288 loops=3)
                                                                                                                             Buffers: shared hit=384 read=9189
                                                                                                                             I/O Timings: shared read=277.233
                                                                                                                       ->  Parallel Hash  (cost=336749.49..336749.49 rows=129634 width=88) (actual time=5574.654..5574.694 rows=103707 loops=3)
                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 5152kB
                                                                                                                             Buffers: shared hit=4850 read=108065, temp read=107041 written=111196
                                                                                                                             I/O Timings: shared read=7158.083, temp read=419.934 write=1445.540
                                                                                                                             ->  Parallel Hash Join  (cost=303982.78..336749.49 rows=129634 width=88) (actual time=5417.855..5528.633 rows=103707 loops=3)
                                                                                                                                   Hash Cond: (("Td270e16c00"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                   Buffers: shared hit=4850 read=108065, temp read=107041 written=107552
                                                                                                                                   I/O Timings: shared read=7158.083, temp read=419.934 write=1397.626
                                                                                                                                   ->  Parallel Seq Scan on "Td270e16c00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.040..847.942 rows=590288 loops=3)
                                                                                                                                         Buffers: shared hit=384 read=10896
                                                                                                                                         I/O Timings: shared read=2400.416
                                                                                                                                   ->  Parallel Hash  (cost=300209.36..300209.36 rows=129634 width=112) (actual time=4446.018..4446.056 rows=103707 loops=3)
                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                         Buffers: shared hit=4466 read=97169, temp read=93111 written=97976
                                                                                                                                         I/O Timings: shared read=4757.667, temp read=365.734 write=1269.738
                                                                                                                                         ->  Parallel Hash Join  (cost=270845.65..300209.36 rows=129634 width=112) (actual time=4294.734..4398.125 rows=103707 loops=3)
                                                                                                                                               Hash Cond: (("T5b22144900"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                               Buffers: shared hit=4466 read=97169, temp read=93111 written=93564
                                                                                                                                               I/O Timings: shared read=4757.667, temp read=365.734 write=1214.015
                                                                                                                                               ->  Parallel Seq Scan on "T5b22144900"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.125..384.321 rows=590288 loops=3)
                                                                                                                                                     Buffers: shared hit=384 read=9189
                                                                                                                                                     I/O Timings: shared read=1007.211
                                                                                                                                               ->  Parallel Hash  (cost=267326.22..267326.22 rows=129634 width=96) (actual time=3799.983..3800.019 rows=103707 loops=3)
                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                     Buffers: shared hit=4082 read=87980, temp read=81443 written=85724
                                                                                                                                                     I/O Timings: shared read=3750.456, temp read=320.831 write=1113.993
                                                                                                                                                     ->  Parallel Hash Join  (cost=231124.51..267326.22 rows=129634 width=96) (actual time=3640.064..3754.089 rows=103707 loops=3)
                                                                                                                                                           Hash Cond: (("T5b5e0b4000"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                           Buffers: shared hit=4082 read=87980, temp read=81443 written=81828
                                                                                                                                                           I/O Timings: shared read=3750.456, temp read=320.831 write=1063.523
                                                                                                                                                           ->  Parallel Seq Scan on "T5b5e0b4000"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.076..111.466 rows=590288 loops=3)
                                                                                                                                                                 Buffers: shared hit=384 read=12638
                                                                                                                                                                 I/O Timings: shared read=158.083
                                                                                                                                                           ->  Parallel Hash  (cost=227098.09..227098.09 rows=129634 width=128) (actual time=3368.309..3368.341 rows=103707 loops=3)
                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 6688kB
                                                                                                                                                                 Buffers: shared hit=3698 read=75342, temp read=65252 written=70536
                                                                                                                                                                 I/O Timings: shared read=3592.373, temp read=258.327 write=911.388
                                                                                                                                                                 ->  Parallel Hash Join  (cost=197480.37..227098.09 rows=129634 width=128) (actual time=3209.589..3315.685 rows=103707 loops=3)
                                                                                                                                                                       Hash Cond: (("Tfa4505c500"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                       Buffers: shared hit=3698 read=75342, temp read=65252 written=65584
                                                                                                                                                                       I/O Timings: shared read=3592.373, temp read=258.327 write=848.736
                                                                                                                                                                       ->  Parallel Seq Scan on "Tfa4505c500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.042..100.177 rows=590288 loops=3)
                                                                                                                                                                             Buffers: shared hit=288 read=9285
                                                                                                                                                                             I/O Timings: shared read=162.692
                                                                                                                                                                       ->  Parallel Hash  (cost=193706.95..193706.95 rows=129634 width=112) (actual time=2998.271..2998.300 rows=103707 loops=3)
                                                                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                             Buffers: shared hit=3410 read=66057, temp read=53052 written=57744
                                                                                                                                                                             I/O Timings: shared read=3429.681, temp read=209.366 write=745.262
                                                                                                                                                                             ->  Parallel Hash Join  (cost=164343.24..193706.95 rows=129634 width=112) (actual time=2852.666..2947.909 rows=103707 loops=3)
                                                                                                                                                                                   Hash Cond: (("Tfa45022400"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                   Buffers: shared hit=3410 read=66057, temp read=53052 written=53312
                                                                                                                                                                                   I/O Timings: shared read=3429.681, temp read=209.366 write=689.902
                                                                                                                                                                                   ->  Parallel Seq Scan on "Tfa45022400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.040..124.576 rows=590288 loops=3)
                                                                                                                                                                                         Buffers: shared hit=288 read=9285
                                                                                                                                                                                         I/O Timings: shared read=230.458
                                                                                                                                                                                   ->  Parallel Hash  (cost=160823.81..160823.81 rows=129634 width=96) (actual time=2604.998..2605.020 rows=103707 loops=3)
                                                                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                         Buffers: shared hit=3122 read=56772, temp read=41383 written=45488
                                                                                                                                                                                         I/O Timings: shared read=3199.223, temp read=163.845 write=587.932
                                                                                                                                                                                         ->  Parallel Hash Join  (cost=124875.10..160823.81 rows=129634 width=96) (actual time=2450.148..2559.641 rows=103707 loops=3)
                                                                                                                                                                                               Hash Cond: (("Tedb9668900"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                               Buffers: shared hit=3122 read=56772, temp read=41383 written=41580
                                                                                                                                                                                               I/O Timings: shared read=3199.223, temp read=163.845 write=538.290
                                                                                                                                                                                               ->  Parallel Seq Scan on "Tedb9668900"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.070..411.819 rows=590288 loops=3)
                                                                                                                                                                                                     Buffers: shared hit=288 read=12734
                                                                                                                                                                                                     I/O Timings: shared read=1061.847
                                                                                                                                                                                               ->  Parallel Hash  (cost=121101.68..121101.68 rows=129634 width=112) (actual time=1879.779..1879.797 rows=103707 loops=3)
                                                                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                                                     Buffers: shared hit=2834 read=44038, temp read=25730 written=30280
                                                                                                                                                                                                     I/O Timings: shared read=2137.376, temp read=102.543 write=390.641
                                                                                                                                                                                                     ->  Parallel Hash Join  (cost=91737.97..121101.68 rows=129634 width=112) (actual time=1726.928..1831.388 rows=103707 loops=3)
                                                                                                                                                                                                           Hash Cond: (("Tfa4502a500"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                                           Buffers: shared hit=2834 read=44038, temp read=25730 written=25860
                                                                                                                                                                                                           I/O Timings: shared read=2137.376, temp read=102.543 write=335.728
                                                                                                                                                                                                           ->  Parallel Seq Scan on "Tfa4502a500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.037..460.098 rows=590288 loops=3)
                                                                                                                                                                                                                 Buffers: shared hit=288 read=9285
                                                                                                                                                                                                                 I/O Timings: shared read=1235.829
                                                                                                                                                                                                           ->  Parallel Hash  (cost=88218.54..88218.54 rows=129634 width=96) (actual time=1156.244..1156.257 rows=103707 loops=3)
                                                                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                                                 Buffers: shared hit=2546 read=34753, temp read=14061 written=18036
                                                                                                                                                                                                                 I/O Timings: shared read=901.548, temp read=55.470 write=233.467
                                                                                                                                                                                                                 ->  Parallel Hash Join  (cost=53029.83..88218.54 rows=129634 width=96) (actual time=1012.473..1110.193 rows=103707 loops=3)
                                                                                                                                                                                                                       Hash Cond: (("Tc9e51c8100"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                                                                       Buffers: shared hit=2546 read=34753, temp read=14061 written=14132
                                                                                                                                                                                                                       I/O Timings: shared read=901.548, temp read=55.470 write=182.504
                                                                                                                                                                                                                       ->  Parallel Seq Scan on "Tc9e51c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.074..76.763 rows=590288 loops=3)
                                                                                                                                                                                                                             Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                             I/O Timings: shared read=64.820
                                                                                                                                                                                                                       ->  Parallel Hash  (cost=50016.41..50016.41 rows=129634 width=64) (actual time=784.162..784.170 rows=103707 loops=3)
                                                                                                                                                                                                                             Buckets: 131072  Batches: 8  Memory Usage: 4704kB
                                                                                                                                                                                                                             Buffers: shared hit=2258 read=22019, temp written=2840
                                                                                                                                                                                                                             I/O Timings: shared read=836.728, temp write=41.761
                                                                                                                                                                                                                             ->  Parallel Hash Join  (cost=26308.70..50016.41 rows=129634 width=64) (actual time=417.305..743.385 rows=103707 loops=3)
                                                                                                                                                                                                                                   Hash Cond: (("T528b9c8100"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                                                                   Buffers: shared hit=2258 read=22019
                                                                                                                                                                                                                                   I/O Timings: shared read=836.728
                                                                                                                                                                                                                                   ->  Parallel Seq Scan on "T528b9c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.049..181.066 rows=590288 loops=3)
                                                                                                                                                                                                                                         Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                                         I/O Timings: shared read=399.280
                                                                                                                                                                                                                                   ->  Parallel Hash  (cost=24688.27..24688.27 rows=129634 width=32) (actual time=414.053..414.059 rows=103707 loops=3)
                                                                                                                                                                                                                                         Buckets: 524288  Batches: 1  Memory Usage: 23616kB
                                                                                                                                                                                                                                         Buffers: shared hit=1970 read=9285
                                                                                                                                                                                                                                         I/O Timings: shared read=437.448
                                                                                                                                                                                                                                         ->  Parallel Hash Join  (cost=5799.79..24688.27 rows=129634 width=32) (actual time=320.665..373.911 rows=103707 loops=3)
                                                                                                                                                                                                                                               Hash Cond: (("Tfa45022500"."Tfa45022500_uid")::uuid = ("Tfa45026200"."Tfa45026200_uid")::uuid)
                                                                                                                                                                                                                                               Buffers: shared hit=1970 read=9285
                                                                                                                                                                                                                                               I/O Timings: shared read=437.448
                                                                                                                                                                                                                                               ->  Parallel Seq Scan on "Tfa45022500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.070..193.040 rows=590288 loops=3)
                                                                                                                                                                                                                                                     Buffers: shared hit=288 read=9285
                                                                                                                                                                                                                                                     I/O Timings: shared read=437.448
                                                                                                                                                                                                                                               ->  Parallel Hash  (cost=3512.13..3512.13 rows=183013 width=16) (actual time=47.243..47.245 rows=103707 loops=3)
                                                                                                                                                                                                                                                     Buckets: 524288  Batches: 1  Memory Usage: 18720kB
                                                                                                                                                                                                                                                     Buffers: shared hit=1682
                                                                                                                                                                                                                                                     ->  Parallel Seq Scan on "Tfa45026200"  (cost=0.00..3512.13 rows=183013 width=16) (actual time=0.011..9.161 rows=103707 loops=3)
                                                                                                                                                                                                                                                           Buffers: shared hit=1682
                                         ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=45.461..45.465 rows=99904 loops=3)
                                               Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                               Buffers: shared hit=1621
                                               ->  Parallel Seq Scan on "Tfa45062900"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.014..9.626 rows=99904 loops=3)
                                                     Buffers: shared hit=1621
                                   ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=1408.055..1408.056 rows=99904 loops=3)
                                         Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                         Buffers: shared hit=1621
                                         ->  Parallel Seq Scan on "T2448628400"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.007..9.496 rows=99904 loops=3)
                                               Buffers: shared hit=1621
   ->  CTE Scan on patient_hospitalisation_debut_fin  (cost=0.00..6860.08 rows=343004 width=40) (actual time=11894.264..11937.018 rows=311122 loops=1)
         Buffers: shared hit=3269 read=61962, temp read=74426 written=75294
         I/O Timings: shared read=3877.768, temp read=297.720 write=993.627
   ->  Hash  (cost=18205415.00..18205415.00 rows=200 width=48) (actual time=2210.362..2210.369 rows=166997 loops=1)
         Buckets: 262144 (originally 1024)  Batches: 2 (originally 1)  Memory Usage: 6617kB
         Buffers: temp read=14531 written=16772
         I/O Timings: temp read=52.749 write=172.108
         ->  Subquery Scan on nombre_semaines  (cost=18205409.50..18205415.00 rows=200 width=48) (actual time=1653.417..2167.353 rows=166997 loops=1)
               Buffers: temp read=14531 written=16367
               I/O Timings: temp read=52.749 write=167.032
               ->  HashAggregate  (cost=18205409.50..18205413.00 rows=200 width=48) (actual time=1653.406..2150.215 rows=166997 loops=1)
                     Group Key: curr.hospitalisation
                     Batches: 21  Memory Usage: 8265kB  Disk Usage: 36648kB
                     Buffers: temp read=14531 written=16367
                     I/O Timings: temp read=52.749 write=167.032
                     ->  Merge Join  (cost=96723.78..11864470.71 rows=195105809 width=40) (actual time=671.345..1166.339 rows=703895 loops=1)
                           Merge Cond: ((curr.patient)::uuid = (prev.patient)::uuid)
                           Join Filter: (((curr.hospitalisation)::uuid <> (prev.hospitalisation)::uuid) AND ((prev.date_admission_hospitalisation)::timestamp without time zone <= (curr.date_admission_hospitalisation)::timestamp without time zone))
                           Rows Removed by Join Filter: 1015015
                           Buffers: temp read=7903 written=6330
                           I/O Timings: temp read=28.055 write=75.302
                           ->  Sort  (cost=47775.64..48633.15 rows=343004 width=40) (actual time=527.427..571.123 rows=311122 loops=1)
                                 Sort Key: curr.patient
                                 Sort Method: external merge  Disk: 15240kB
                                 Buffers: temp read=3491 written=4113
                                 I/O Timings: temp read=12.268 write=49.024
                                 ->  CTE Scan on patient_hospitalisation_debut_fin curr  (cost=0.00..6860.08 rows=343004 width=40) (actual time=0.022..432.848 rows=311122 loops=1)
                                       Buffers: temp read=1586 written=2202
                                       I/O Timings: temp read=5.443 write=26.993
                           ->  Materialize  (cost=48948.14..50663.16 rows=343004 width=48) (actual time=143.829..315.915 rows=1718910 loops=1)
                                 Buffers: temp read=4412 written=2217
                                 I/O Timings: temp read=15.787 write=26.279
                                 ->  Sort  (cost=48948.14..49805.65 rows=343004 width=48) (actual time=143.824..188.410 rows=311122 loops=1)
                                       Sort Key: prev.patient
                                       Sort Method: external merge  Disk: 17672kB
                                       Buffers: temp read=4412 written=2217
                                       I/O Timings: temp read=15.787 write=26.279
                                       ->  CTE Scan on patient_hospitalisation_debut_fin prev  (cost=0.00..6860.08 rows=343004 width=48) (actual time=0.044..47.191 rows=311122 loops=1)
                                             Buffers: temp read=2203 written=1
                                             I/O Timings: temp read=7.708 write=0.030
 Settings: search_path = 'test_mimic'
 Planning:
   Buffers: shared hit=1113
 Planning Time: 28.634 ms
 JIT:
   Functions: 524
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 26.292 ms, Inlining 269.267 ms, Optimization 2119.891 ms, Emission 1452.077 ms, Total 3867.527 ms
 Execution Time: 14679.568 ms
(278 rows)

> Loop number : 3
SET
SET
SET
SET
SET
SET
SET
SET
SET
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Hash Left Join  (cost=18887920.23..18895699.77 rows=343004 width=72) (actual time=14261.462..14747.833 rows=311122 loops=1)
   Hash Cond: ((patient_hospitalisation_debut_fin.hospitalisation)::uuid = (nombre_semaines.hospitalisation)::uuid)
   Buffers: shared hit=11355 read=189748, temp read=245674 written=248041
   I/O Timings: shared read=12206.456, temp read=957.700 write=3148.024
   CTE patient_hospitalisation_debut_fin
     ->  Unique  (cost=637337.74..682502.73 rows=343004 width=48) (actual time=12020.685..12705.194 rows=311122 loops=1)
           Buffers: shared hit=11355 read=189748, temp read=228827 written=229975
           I/O Timings: shared read=12206.456, temp read=893.307 write=2959.110
           ->  Gather Merge  (cost=637337.74..679072.69 rows=343004 width=48) (actual time=12020.685..12636.169 rows=592262 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 Buffers: shared hit=11355 read=189748, temp read=228827 written=229975
                 I/O Timings: shared read=12206.456, temp read=893.307 write=2959.110
                 ->  Unique  (cost=636337.72..638481.49 rows=171502 width=48) (actual time=11990.672..12099.408 rows=197421 loops=3)
                       Buffers: shared hit=11355 read=189748, temp read=228827 written=229975
                       I/O Timings: shared read=12206.456, temp read=893.307 write=2959.110
                       ->  Sort  (cost=636337.72..636766.47 rows=171502 width=48) (actual time=11990.670..12055.616 rows=294355 loops=3)
                             Sort Key: "T2448628400"."T2448628400_uid", "Tfa45026200"."Tfa45026200_uid", "Tcee93e6b00"."Tcee93e6b00_Ontorel-Core_0000004", "Td270e16c00"."Td270e16c00_Ontorel-Core_0000004"
                             Sort Method: external merge  Disk: 16680kB
                             Buffers: shared hit=11355 read=189748, temp read=228827 written=229975
                             I/O Timings: shared read=12206.456, temp read=893.307 write=2959.110
                             Worker 0:  Sort Method: external merge  Disk: 16712kB
                             Worker 1:  Sort Method: external merge  Disk: 16760kB
                             ->  Parallel Hash Join  (cost=577178.76..616149.45 rows=171502 width=48) (actual time=11358.200..11815.145 rows=294355 loops=3)
                                   Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("T2448628400"."T2448628400_uid")::uuid)
                                   Buffers: shared hit=11227 read=189748, temp read=222558 written=223688
                                   I/O Timings: shared read=12206.456, temp read=871.630 write=2879.292
                                   ->  Parallel Hash Join  (cost=571590.98..610111.47 rows=171502 width=64) (actual time=9934.498..10272.888 rows=294355 loops=3)
                                         Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("Tfa45062900"."Tfa45062900_uid")::uuid)
                                         Buffers: shared hit=9590 read=189748, temp read=222558 written=223688
                                         I/O Timings: shared read=12206.456, temp read=871.630 write=2879.292
                                         ->  Parallel Hash Join  (cost=566003.21..604073.49 rows=171502 width=48) (actual time=9887.954..10107.799 rows=294355 loops=3)
                                               Hash Cond: (("Tc68c9cba00"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                               Buffers: shared hit=7969 read=189748, temp read=222558 written=223688
                                               I/O Timings: shared read=12206.456, temp read=871.630 write=2879.292
                                               ->  Parallel Seq Scan on "Tc68c9cba00"  (cost=0.00..21784.05 rows=787905 width=32) (actual time=0.093..210.571 rows=630324 loops=3)
                                                     Buffers: shared hit=288 read=13617
                                                     I/O Timings: shared read=446.444
                                               ->  Parallel Hash  (cost=562016.44..562016.44 rows=171502 width=64) (actual time=9504.274..9504.318 rows=294355 loops=3)
                                                     Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 6272kB
                                                     Buffers: shared hit=7681 read=176131, temp read=202021 written=211580
                                                     I/O Timings: shared read=11760.011, temp read=787.428 write=2724.377
                                                     ->  Parallel Hash Join  (cost=531042.15..562016.44 rows=171502 width=64) (actual time=9191.913..9367.261 rows=294355 loops=3)
                                                           Hash Cond: (("Tfa45020700"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                                           Buffers: shared hit=7681 read=176131, temp read=198424 written=199440
                                                           I/O Timings: shared read=11760.011, temp read=774.773 write=2576.027
                                                           ->  Parallel Seq Scan on "Tfa45020700"  (cost=0.00..18101.05 rows=787905 width=16) (actual time=0.063..236.452 rows=630324 loops=3)
                                                                 Buffers: shared hit=326 read=9896
                                                                 I/O Timings: shared read=556.433
                                                           ->  Parallel Hash  (cost=527390.38..527390.38 rows=171502 width=48) (actual time=8829.121..8829.163 rows=294355 loops=3)
                                                                 Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 5408kB
                                                                 Buffers: shared hit=7355 read=166235, temp read=183179 written=191016
                                                                 I/O Timings: shared read=11203.578, temp read=713.784 write=2465.313
                                                                 ->  Parallel Hash Join  (cost=481032.46..527390.38 rows=171502 width=48) (actual time=8513.228..8673.652 rows=294355 loops=3)
                                                                       Hash Cond: (("T69af2e7200"."Tfa45022500_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                       Buffers: shared hit=7355 read=166235, temp read=177125 written=177956
                                                                       I/O Timings: shared read=11203.578, temp read=692.356 write=2299.661
                                                                       ->  Parallel Seq Scan on "T69af2e7200"  (cost=0.00..26988.69 rows=976169 width=32) (actual time=0.047..328.941 rows=780935 loops=3)
                                                                             Buffers: shared hit=384 read=16843
                                                                             I/O Timings: shared read=795.021
                                                                       ->  Parallel Hash  (cost=477766.04..477766.04 rows=129634 width=80) (actual time=8007.369..8007.409 rows=103707 loops=3)
                                                                             Buckets: 131072  Batches: 8  Memory Usage: 5344kB
                                                                             Buffers: shared hit=6971 read=149392, temp read=158900 written=163028
                                                                             I/O Timings: shared read=10408.557, temp read=618.596 write=2104.098
                                                                             ->  Parallel Hash Join  (cost=445126.33..477766.04 rows=129634 width=80) (actual time=7859.367..7963.291 rows=103707 loops=3)
                                                                                   Hash Cond: (("Tcee93e6b00"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                   Buffers: shared hit=6971 read=149392, temp read=158900 written=159660
                                                                                   I/O Timings: shared read=10408.557, temp read=618.596 write=2060.843
                                                                                   ->  Parallel Seq Scan on "Tcee93e6b00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.036..215.294 rows=590288 loops=3)
                                                                                         Buffers: shared hit=750 read=10530
                                                                                         I/O Timings: shared read=500.719
                                                                                   ->  Parallel Hash  (cost=441479.90..441479.90 rows=129634 width=104) (actual time=7510.994..7511.030 rows=103707 loops=3)
                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5728kB
                                                                                         Buffers: shared hit=6221 read=138862, temp read=145237 written=150088
                                                                                         I/O Timings: shared read=9907.837, temp read=564.457 write=1937.013
                                                                                         ->  Parallel Hash Join  (cost=412242.19..441479.90 rows=129634 width=104) (actual time=7363.279..7461.645 rows=103707 loops=3)
                                                                                               Hash Cond: (("T5b22144800"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                               Buffers: shared hit=6221 read=138862, temp read=145237 written=145940
                                                                                               I/O Timings: shared read=9907.837, temp read=564.457 write=1880.105
                                                                                               ->  Parallel Seq Scan on "T5b22144800"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.607..164.201 rows=590288 loops=3)
                                                                                                     Buffers: shared hit=407 read=9166
                                                                                                     I/O Timings: shared read=344.211
                                                                                               ->  Parallel Hash  (cost=408848.76..408848.76 rows=129634 width=88) (actual time=7071.716..7071.750 rows=103707 loops=3)
                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5120kB
                                                                                                     Buffers: shared hit=5814 read=129696, temp read=133835 written=138104
                                                                                                     I/O Timings: shared read=9563.626, temp read=519.278 write=1776.890
                                                                                                     ->  Parallel Hash Join  (cost=373027.05..408848.76 rows=129634 width=88) (actual time=6909.302..7025.500 rows=103707 loops=3)
                                                                                                           Hash Cond: (("Tbe02328700"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                           Buffers: shared hit=5814 read=129696, temp read=133835 written=134464
                                                                                                           I/O Timings: shared read=9563.626, temp read=519.278 write=1729.252
                                                                                                           ->  Parallel Seq Scan on "Tbe02328700"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.068..326.356 rows=590288 loops=3)
                                                                                                                 Buffers: shared hit=430 read=12592
                                                                                                                 I/O Timings: shared read=799.099
                                                                                                           ->  Parallel Hash  (cost=369380.63..369380.63 rows=129634 width=104) (actual time=6422.295..6422.326 rows=103707 loops=3)
                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5760kB
                                                                                                                 Buffers: shared hit=5384 read=117104, temp read=118449 written=123172
                                                                                                                 I/O Timings: shared read=8764.527, temp read=458.920 write=1577.194
                                                                                                                 ->  Parallel Hash Join  (cost=340142.92..369380.63 rows=129634 width=104) (actual time=6270.606..6374.999 rows=103707 loops=3)
                                                                                                                       Hash Cond: (("Tfa4502a400"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                                       Buffers: shared hit=5384 read=117104, temp read=118449 written=119024
                                                                                                                       I/O Timings: shared read=8764.527, temp read=458.920 write=1525.924
                                                                                                                       ->  Parallel Seq Scan on "Tfa4502a400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.035..252.193 rows=590288 loops=3)
                                                                                                                             Buffers: shared hit=406 read=9167
                                                                                                                             I/O Timings: shared read=610.351
                                                                                                                       ->  Parallel Hash  (cost=336749.49..336749.49 rows=129634 width=88) (actual time=5902.761..5902.790 rows=103707 loops=3)
                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 5152kB
                                                                                                                             Buffers: shared hit=4978 read=107937, temp read=107047 written=111192
                                                                                                                             I/O Timings: shared read=8154.176, temp read=414.861 write=1420.197
                                                                                                                             ->  Parallel Hash Join  (cost=303982.78..336749.49 rows=129634 width=88) (actual time=5739.198..5855.809 rows=103707 loops=3)
                                                                                                                                   Hash Cond: (("Td270e16c00"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                   Buffers: shared hit=4978 read=107937, temp read=107047 written=107544
                                                                                                                                   I/O Timings: shared read=8154.176, temp read=414.861 write=1372.746
                                                                                                                                   ->  Parallel Seq Scan on "Td270e16c00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.038..110.553 rows=590288 loops=3)
                                                                                                                                         Buffers: shared hit=409 read=10871
                                                                                                                                         I/O Timings: shared read=193.336
                                                                                                                                   ->  Parallel Hash  (cost=300209.36..300209.36 rows=129634 width=112) (actual time=5512.524..5512.551 rows=103707 loops=3)
                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                         Buffers: shared hit=4569 read=97066, temp read=93116 written=97972
                                                                                                                                         I/O Timings: shared read=7960.839, temp read=359.977 write=1255.850
                                                                                                                                         ->  Parallel Hash Join  (cost=270845.65..300209.36 rows=129634 width=112) (actual time=5361.898..5465.262 rows=103707 loops=3)
                                                                                                                                               Hash Cond: (("T5b22144900"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                               Buffers: shared hit=4569 read=97066, temp read=93116 written=93564
                                                                                                                                               I/O Timings: shared read=7960.839, temp read=359.977 write=1201.191
                                                                                                                                               ->  Parallel Seq Scan on "T5b22144900"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.052..89.971 rows=590288 loops=3)
                                                                                                                                                     Buffers: shared hit=406 read=9167
                                                                                                                                                     I/O Timings: shared read=126.220
                                                                                                                                               ->  Parallel Hash  (cost=267326.22..267326.22 rows=129634 width=96) (actual time=5164.763..5164.787 rows=103707 loops=3)
                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5472kB
                                                                                                                                                     Buffers: shared hit=4163 read=87899, temp read=81448 written=85740
                                                                                                                                                     I/O Timings: shared read=7834.620, temp read=314.650 write=1105.618
                                                                                                                                                     ->  Parallel Hash Join  (cost=231124.51..267326.22 rows=129634 width=96) (actual time=5008.582..5119.825 rows=103707 loops=3)
                                                                                                                                                           Hash Cond: (("T5b5e0b4000"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                           Buffers: shared hit=4163 read=87899, temp read=81448 written=81836
                                                                                                                                                           I/O Timings: shared read=7834.620, temp read=314.650 write=1056.442
                                                                                                                                                           ->  Parallel Seq Scan on "T5b5e0b4000"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.068..287.216 rows=590288 loops=3)
                                                                                                                                                                 Buffers: shared hit=406 read=12616
                                                                                                                                                                 I/O Timings: shared read=684.375
                                                                                                                                                           ->  Parallel Hash  (cost=227098.09..227098.09 rows=129634 width=128) (actual time=4562.747..4562.769 rows=103707 loops=3)
                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 6688kB
                                                                                                                                                                 Buffers: shared hit=3757 read=75283, temp read=65258 written=70540
                                                                                                                                                                 I/O Timings: shared read=7150.245, temp read=252.739 write=905.963
                                                                                                                                                                 ->  Parallel Hash Join  (cost=197480.37..227098.09 rows=129634 width=128) (actual time=4403.955..4510.768 rows=103707 loops=3)
                                                                                                                                                                       Hash Cond: (("Tfa4505c500"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                       Buffers: shared hit=3757 read=75283, temp read=65258 written=65584
                                                                                                                                                                       I/O Timings: shared read=7150.245, temp read=252.739 write=844.810
                                                                                                                                                                       ->  Parallel Seq Scan on "Tfa4505c500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.043..254.100 rows=590288 loops=3)
                                                                                                                                                                             Buffers: shared hit=306 read=9267
                                                                                                                                                                             I/O Timings: shared read=619.233
                                                                                                                                                                       ->  Parallel Hash  (cost=193706.95..193706.95 rows=129634 width=112) (actual time=4036.605..4036.624 rows=103707 loops=3)
                                                                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                             Buffers: shared hit=3451 read=66016, temp read=53057 written=57756
                                                                                                                                                                             I/O Timings: shared read=6531.012, temp read=205.698 write=741.788
                                                                                                                                                                             ->  Parallel Hash Join  (cost=164343.24..193706.95 rows=129634 width=112) (actual time=3888.372..3986.208 rows=103707 loops=3)
                                                                                                                                                                                   Hash Cond: (("Tfa45022400"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                   Buffers: shared hit=3451 read=66016, temp read=53057 written=53324
                                                                                                                                                                                   I/O Timings: shared read=6531.012, temp read=205.698 write=686.652
                                                                                                                                                                                   ->  Parallel Seq Scan on "Tfa45022400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.035..293.770 rows=590288 loops=3)
                                                                                                                                                                                         Buffers: shared hit=312 read=9261
                                                                                                                                                                                         I/O Timings: shared read=733.136
                                                                                                                                                                                   ->  Parallel Hash  (cost=160823.81..160823.81 rows=129634 width=96) (actual time=3469.450..3469.466 rows=103707 loops=3)
                                                                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                         Buffers: shared hit=3139 read=56755, temp read=41389 written=45488
                                                                                                                                                                                         I/O Timings: shared read=5797.876, temp read=160.879 write=580.498
                                                                                                                                                                                         ->  Parallel Hash Join  (cost=124875.10..160823.81 rows=129634 width=96) (actual time=3315.548..3424.872 rows=103707 loops=3)
                                                                                                                                                                                               Hash Cond: (("Tedb9668900"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                               Buffers: shared hit=3139 read=56755, temp read=41389 written=41592
                                                                                                                                                                                               I/O Timings: shared read=5797.876, temp read=160.879 write=531.399
                                                                                                                                                                                               ->  Parallel Seq Scan on "Tedb9668900"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.063..796.611 rows=590288 loops=3)
                                                                                                                                                                                                     Buffers: shared hit=332 read=12690
                                                                                                                                                                                                     I/O Timings: shared read=2220.213
                                                                                                                                                                                               ->  Parallel Hash  (cost=121101.68..121101.68 rows=129634 width=112) (actual time=2364.501..2364.515 rows=103707 loops=3)
                                                                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                                                     Buffers: shared hit=2807 read=44065, temp read=25731 written=30296
                                                                                                                                                                                                     I/O Timings: shared read=3577.662, temp read=100.473 write=385.296
                                                                                                                                                                                                     ->  Parallel Hash Join  (cost=91737.97..121101.68 rows=129634 width=112) (actual time=2215.552..2317.551 rows=103707 loops=3)
                                                                                                                                                                                                           Hash Cond: (("Tfa4502a500"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                                           Buffers: shared hit=2807 read=44065, temp read=25731 written=25880
                                                                                                                                                                                                           I/O Timings: shared read=3577.662, temp read=100.473 write=331.558
                                                                                                                                                                                                           ->  Parallel Seq Scan on "Tfa4502a500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.036..399.837 rows=590288 loops=3)
                                                                                                                                                                                                                 Buffers: shared hit=288 read=9285
                                                                                                                                                                                                                 I/O Timings: shared read=1054.322
                                                                                                                                                                                                           ->  Parallel Hash  (cost=88218.54..88218.54 rows=129634 width=96) (actual time=1706.234..1706.245 rows=103707 loops=3)
                                                                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                                                 Buffers: shared hit=2519 read=34780, temp read=14062 written=18052
                                                                                                                                                                                                                 I/O Timings: shared read=2523.341, temp read=55.141 write=231.709
                                                                                                                                                                                                                 ->  Parallel Hash Join  (cost=53029.83..88218.54 rows=129634 width=96) (actual time=1562.610..1661.174 rows=103707 loops=3)
                                                                                                                                                                                                                       Hash Cond: (("Tc9e51c8100"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                                                                       Buffers: shared hit=2519 read=34780, temp read=14062 written=14136
                                                                                                                                                                                                                       I/O Timings: shared read=2523.341, temp read=55.141 write=182.872
                                                                                                                                                                                                                       ->  Parallel Seq Scan on "Tc9e51c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.067..596.480 rows=590288 loops=3)
                                                                                                                                                                                                                             Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                             I/O Timings: shared read=1622.167
                                                                                                                                                                                                                       ->  Parallel Hash  (cost=50016.41..50016.41 rows=129634 width=64) (actual time=812.864..812.871 rows=103707 loops=3)
                                                                                                                                                                                                                             Buckets: 131072  Batches: 8  Memory Usage: 4704kB
                                                                                                                                                                                                                             Buffers: shared hit=2231 read=22046, temp written=2844
                                                                                                                                                                                                                             I/O Timings: shared read=901.173, temp write=36.376
                                                                                                                                                                                                                             ->  Parallel Hash Join  (cost=26308.70..50016.41 rows=129634 width=64) (actual time=408.500..773.644 rows=103707 loops=3)
                                                                                                                                                                                                                                   Hash Cond: (("T528b9c8100"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                                                                   Buffers: shared hit=2231 read=22046
                                                                                                                                                                                                                                   I/O Timings: shared read=901.173
                                                                                                                                                                                                                                   ->  Parallel Seq Scan on "T528b9c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.044..216.454 rows=590288 loops=3)
                                                                                                                                                                                                                                         Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                                         I/O Timings: shared read=503.457
                                                                                                                                                                                                                                   ->  Parallel Hash  (cost=24688.27..24688.27 rows=129634 width=32) (actual time=405.231..405.236 rows=103707 loops=3)
                                                                                                                                                                                                                                         Buckets: 524288  Batches: 1  Memory Usage: 23616kB
                                                                                                                                                                                                                                         Buffers: shared hit=1943 read=9312
                                                                                                                                                                                                                                         I/O Timings: shared read=397.716
                                                                                                                                                                                                                                         ->  Parallel Hash Join  (cost=5799.79..24688.27 rows=129634 width=32) (actual time=307.740..365.636 rows=103707 loops=3)
                                                                                                                                                                                                                                               Hash Cond: (("Tfa45022500"."Tfa45022500_uid")::uuid = ("Tfa45026200"."Tfa45026200_uid")::uuid)
                                                                                                                                                                                                                                               Buffers: shared hit=1943 read=9312
                                                                                                                                                                                                                                               I/O Timings: shared read=397.716
                                                                                                                                                                                                                                               ->  Parallel Seq Scan on "Tfa45022500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.216..179.953 rows=590288 loops=3)
                                                                                                                                                                                                                                                     Buffers: shared hit=261 read=9312
                                                                                                                                                                                                                                                     I/O Timings: shared read=397.716
                                                                                                                                                                                                                                               ->  Parallel Hash  (cost=3512.13..3512.13 rows=183013 width=16) (actual time=49.854..49.856 rows=103707 loops=3)
                                                                                                                                                                                                                                                     Buckets: 524288  Batches: 1  Memory Usage: 18752kB
                                                                                                                                                                                                                                                     Buffers: shared hit=1682
                                                                                                                                                                                                                                                     ->  Parallel Seq Scan on "Tfa45026200"  (cost=0.00..3512.13 rows=183013 width=16) (actual time=0.012..9.338 rows=103707 loops=3)
                                                                                                                                                                                                                                                           Buffers: shared hit=1682
                                         ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=45.415..45.415 rows=99904 loops=3)
                                               Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                               Buffers: shared hit=1621
                                               ->  Parallel Seq Scan on "Tfa45062900"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.013..9.705 rows=99904 loops=3)
                                                     Buffers: shared hit=1621
                                   ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=1421.858..1421.858 rows=99904 loops=3)
                                         Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                         Buffers: shared hit=1621
                                         ->  Parallel Seq Scan on "T2448628400"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.006..9.536 rows=99904 loops=3)
                                               Buffers: shared hit=1621
   ->  CTE Scan on patient_hospitalisation_debut_fin  (cost=0.00..6860.08 rows=343004 width=40) (actual time=12020.689..12063.572 rows=311122 loops=1)
         Buffers: shared hit=3239 read=62442, temp read=76225 written=76511
         I/O Timings: shared read=4076.479, temp read=299.470 write=980.809
   ->  Hash  (cost=18205415.00..18205415.00 rows=200 width=48) (actual time=2240.715..2240.722 rows=166997 loops=1)
         Buckets: 262144 (originally 1024)  Batches: 2 (originally 1)  Memory Usage: 6617kB
         Buffers: temp read=14540 written=16772
         I/O Timings: temp read=53.510 write=173.178
         ->  Subquery Scan on nombre_semaines  (cost=18205409.50..18205415.00 rows=200 width=48) (actual time=1683.915..2197.150 rows=166997 loops=1)
               Buffers: temp read=14540 written=16367
               I/O Timings: temp read=53.510 write=168.144
               ->  HashAggregate  (cost=18205409.50..18205413.00 rows=200 width=48) (actual time=1683.905..2179.496 rows=166997 loops=1)
                     Group Key: curr.hospitalisation
                     Batches: 21  Memory Usage: 8265kB  Disk Usage: 36648kB
                     Buffers: temp read=14540 written=16367
                     I/O Timings: temp read=53.510 write=168.144
                     ->  Merge Join  (cost=96723.78..11864470.71 rows=195105809 width=40) (actual time=704.007..1198.587 rows=703895 loops=1)
                           Merge Cond: ((curr.patient)::uuid = (prev.patient)::uuid)
                           Join Filter: (((curr.hospitalisation)::uuid <> (prev.hospitalisation)::uuid) AND ((prev.date_admission_hospitalisation)::timestamp without time zone <= (curr.date_admission_hospitalisation)::timestamp without time zone))
                           Rows Removed by Join Filter: 1015015
                           Buffers: temp read=7912 written=6330
                           I/O Timings: temp read=28.692 write=76.657
                           ->  Sort  (cost=47775.64..48633.15 rows=343004 width=40) (actual time=552.755..596.439 rows=311122 loops=1)
                                 Sort Key: curr.patient
                                 Sort Method: external merge  Disk: 15240kB
                                 Buffers: temp read=3500 written=4113
                                 I/O Timings: temp read=12.565 write=49.419
                                 ->  CTE Scan on patient_hospitalisation_debut_fin curr  (cost=0.00..6860.08 rows=343004 width=40) (actual time=0.022..461.282 rows=311122 loops=1)
                                       Buffers: temp read=1595 written=2202
                                       I/O Timings: temp read=5.494 write=27.433
                           ->  Materialize  (cost=48948.14..50663.16 rows=343004 width=48) (actual time=151.170..322.833 rows=1718910 loops=1)
                                 Buffers: temp read=4412 written=2217
                                 I/O Timings: temp read=16.127 write=27.238
                                 ->  Sort  (cost=48948.14..49805.65 rows=343004 width=48) (actual time=151.164..196.095 rows=311122 loops=1)
                                       Sort Key: prev.patient
                                       Sort Method: external merge  Disk: 17672kB
                                       Buffers: temp read=4412 written=2217
                                       I/O Timings: temp read=16.127 write=27.238
                                       ->  CTE Scan on patient_hospitalisation_debut_fin prev  (cost=0.00..6860.08 rows=343004 width=48) (actual time=0.045..49.791 rows=311122 loops=1)
                                             Buffers: temp read=2203 written=1
                                             I/O Timings: temp read=8.013 write=0.031
 Settings: search_path = 'test_mimic'
 Planning:
   Buffers: shared hit=1113
 Planning Time: 29.203 ms
 JIT:
   Functions: 524
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 25.972 ms, Inlining 268.430 ms, Optimization 2136.465 ms, Emission 1458.392 ms, Total 3889.259 ms
 Execution Time: 14829.218 ms
(278 rows)

> Loop number : 4
SET
SET
SET
SET
SET
SET
SET
SET
SET
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Hash Left Join  (cost=18887920.23..18895699.77 rows=343004 width=72) (actual time=15763.139..16220.400 rows=311122 loops=1)
   Hash Cond: ((patient_hospitalisation_debut_fin.hospitalisation)::uuid = (nombre_semaines.hospitalisation)::uuid)
   Buffers: shared hit=11376 read=189727, temp read=245624 written=247956
   I/O Timings: shared read=16846.039, temp read=961.011 write=3156.135
   CTE patient_hospitalisation_debut_fin
     ->  Unique  (cost=637337.74..682502.73 rows=343004 width=48) (actual time=13558.383..14186.839 rows=311122 loops=1)
           Buffers: shared hit=11376 read=189727, temp read=228777 written=229890
           I/O Timings: shared read=16846.039, temp read=896.630 write=2972.097
           ->  Gather Merge  (cost=637337.74..679072.69 rows=343004 width=48) (actual time=13558.383..14118.051 rows=592448 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 Buffers: shared hit=11376 read=189727, temp read=228777 written=229890
                 I/O Timings: shared read=16846.039, temp read=896.630 write=2972.097
                 ->  Unique  (cost=636337.72..638481.49 rows=171502 width=48) (actual time=13528.548..13636.870 rows=197483 loops=3)
                       Buffers: shared hit=11376 read=189727, temp read=228777 written=229890
                       I/O Timings: shared read=16846.039, temp read=896.630 write=2972.097
                       ->  Sort  (cost=636337.72..636766.47 rows=171502 width=48) (actual time=13528.546..13593.416 rows=294355 loops=3)
                             Sort Key: "T2448628400"."T2448628400_uid", "Tfa45026200"."Tfa45026200_uid", "Tcee93e6b00"."Tcee93e6b00_Ontorel-Core_0000004", "Td270e16c00"."Td270e16c00_Ontorel-Core_0000004"
                             Sort Method: external merge  Disk: 16752kB
                             Buffers: shared hit=11376 read=189727, temp read=228777 written=229890
                             I/O Timings: shared read=16846.039, temp read=896.630 write=2972.097
                             Worker 0:  Sort Method: external merge  Disk: 16672kB
                             Worker 1:  Sort Method: external merge  Disk: 16720kB
                             ->  Parallel Hash Join  (cost=577178.76..616149.45 rows=171502 width=48) (actual time=12896.354..13353.022 rows=294355 loops=3)
                                   Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("T2448628400"."T2448628400_uid")::uuid)
                                   Buffers: shared hit=11248 read=189727, temp read=222509 written=223604
                                   I/O Timings: shared read=16846.039, temp read=875.207 write=2895.723
                                   ->  Parallel Hash Join  (cost=571590.98..610111.47 rows=171502 width=64) (actual time=11488.536..11826.436 rows=294355 loops=3)
                                         Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("Tfa45062900"."Tfa45062900_uid")::uuid)
                                         Buffers: shared hit=9611 read=189727, temp read=222509 written=223604
                                         I/O Timings: shared read=16846.039, temp read=875.207 write=2895.723
                                         ->  Parallel Hash Join  (cost=566003.21..604073.49 rows=171502 width=48) (actual time=11441.673..11660.874 rows=294355 loops=3)
                                               Hash Cond: (("Tc68c9cba00"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                               Buffers: shared hit=7990 read=189727, temp read=222509 written=223604
                                               I/O Timings: shared read=16846.039, temp read=875.207 write=2895.723
                                               ->  Parallel Seq Scan on "Tc68c9cba00"  (cost=0.00..21784.05 rows=787905 width=32) (actual time=0.089..233.061 rows=630324 loops=3)
                                                     Buffers: shared hit=302 read=13603
                                                     I/O Timings: shared read=521.090
                                               ->  Parallel Hash  (cost=562016.44..562016.44 rows=171502 width=64) (actual time=11037.610..11037.659 rows=294355 loops=3)
                                                     Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 6272kB
                                                     Buffers: shared hit=7688 read=176124, temp read=201975 written=211496
                                                     I/O Timings: shared read=16324.949, temp read=793.949 write=2738.727
                                                     ->  Parallel Hash Join  (cost=531042.15..562016.44 rows=171502 width=64) (actual time=10726.570..10901.837 rows=294355 loops=3)
                                                           Hash Cond: (("Tfa45020700"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                                           Buffers: shared hit=7688 read=176124, temp read=198420 written=199392
                                                           I/O Timings: shared read=16324.949, temp read=781.056 write=2589.983
                                                           ->  Parallel Seq Scan on "Tfa45020700"  (cost=0.00..18101.05 rows=787905 width=16) (actual time=0.051..116.692 rows=630324 loops=3)
                                                                 Buffers: shared hit=345 read=9877
                                                                 I/O Timings: shared read=200.452
                                                           ->  Parallel Hash  (cost=527390.38..527390.38 rows=171502 width=48) (actual time=10488.182..10488.228 rows=294355 loops=3)
                                                                 Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 5408kB
                                                                 Buffers: shared hit=7343 read=166247, temp read=183174 written=190988
                                                                 I/O Timings: shared read=16124.497, temp read=719.894 write=2483.634
                                                                 ->  Parallel Hash Join  (cost=481032.46..527390.38 rows=171502 width=48) (actual time=10176.519..10334.833 rows=294355 loops=3)
                                                                       Hash Cond: (("T69af2e7200"."Tfa45022500_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                       Buffers: shared hit=7343 read=166247, temp read=177117 written=177920
                                                                       I/O Timings: shared read=16124.497, temp read=697.932 write=2320.644
                                                                       ->  Parallel Seq Scan on "T69af2e7200"  (cost=0.00..26988.69 rows=976169 width=32) (actual time=0.544..303.487 rows=780935 loops=3)
                                                                             Buffers: shared hit=384 read=16843
                                                                             I/O Timings: shared read=722.378
                                                                       ->  Parallel Hash  (cost=477766.04..477766.04 rows=129634 width=80) (actual time=9699.305..9699.348 rows=103707 loops=3)
                                                                             Buckets: 131072  Batches: 8  Memory Usage: 5344kB
                                                                             Buffers: shared hit=6959 read=149404, temp read=158893 written=162996
                                                                             I/O Timings: shared read=15402.119, temp read=624.256 write=2131.706
                                                                             ->  Parallel Hash Join  (cost=445126.33..477766.04 rows=129634 width=80) (actual time=9554.669..9655.910 rows=103707 loops=3)
                                                                                   Hash Cond: (("Tcee93e6b00"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                   Buffers: shared hit=6959 read=149404, temp read=158893 written=159628
                                                                                   I/O Timings: shared read=15402.119, temp read=624.256 write=2089.078
                                                                                   ->  Parallel Seq Scan on "Tcee93e6b00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.102..177.627 rows=590288 loops=3)
                                                                                         Buffers: shared hit=592 read=10688
                                                                                         I/O Timings: shared read=391.078
                                                                                   ->  Parallel Hash  (cost=441479.90..441479.90 rows=129634 width=104) (actual time=9247.881..9247.921 rows=103707 loops=3)
                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5728kB
                                                                                         Buffers: shared hit=6367 read=138716, temp read=145228 written=150060
                                                                                         I/O Timings: shared read=15011.041, temp read=569.719 write=1966.742
                                                                                         ->  Parallel Hash Join  (cost=412242.19..441479.90 rows=129634 width=104) (actual time=9106.775..9202.195 rows=103707 loops=3)
                                                                                               Hash Cond: (("T5b22144800"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                               Buffers: shared hit=6367 read=138716, temp read=145228 written=145908
                                                                                               I/O Timings: shared read=15011.041, temp read=569.719 write=1915.525
                                                                                               ->  Parallel Seq Scan on "T5b22144800"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.449..346.205 rows=590288 loops=3)
                                                                                                     Buffers: shared hit=401 read=9172
                                                                                                     I/O Timings: shared read=894.683
                                                                                               ->  Parallel Hash  (cost=408848.76..408848.76 rows=129634 width=88) (actual time=8629.113..8629.150 rows=103707 loops=3)
                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5120kB
                                                                                                     Buffers: shared hit=5966 read=129544, temp read=133829 written=138072
                                                                                                     I/O Timings: shared read=14116.358, temp read=524.453 write=1809.030
                                                                                                     ->  Parallel Hash Join  (cost=373027.05..408848.76 rows=129634 width=88) (actual time=8473.012..8585.153 rows=103707 loops=3)
                                                                                                           Hash Cond: (("Tbe02328700"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                           Buffers: shared hit=5966 read=129544, temp read=133829 written=134432
                                                                                                           I/O Timings: shared read=14116.358, temp read=524.453 write=1762.669
                                                                                                           ->  Parallel Seq Scan on "Tbe02328700"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.085..364.161 rows=590288 loops=3)
                                                                                                                 Buffers: shared hit=416 read=12606
                                                                                                                 I/O Timings: shared read=910.848
                                                                                                           ->  Parallel Hash  (cost=369380.63..369380.63 rows=129634 width=104) (actual time=7948.002..7948.037 rows=103707 loops=3)
                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5760kB
                                                                                                                 Buffers: shared hit=5550 read=116938, temp read=118441 written=123148
                                                                                                                 I/O Timings: shared read=13205.509, temp read=464.648 write=1610.361
                                                                                                                 ->  Parallel Hash Join  (cost=340142.92..369380.63 rows=129634 width=104) (actual time=7798.640..7902.030 rows=103707 loops=3)
                                                                                                                       Hash Cond: (("Tfa4502a400"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                                       Buffers: shared hit=5550 read=116938, temp read=118441 written=118996
                                                                                                                       I/O Timings: shared read=13205.509, temp read=464.648 write=1559.033
                                                                                                                       ->  Parallel Seq Scan on "Tfa4502a400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.048..186.115 rows=590288 loops=3)
                                                                                                                             Buffers: shared hit=399 read=9174
                                                                                                                             I/O Timings: shared read=413.353
                                                                                                                       ->  Parallel Hash  (cost=336749.49..336749.49 rows=129634 width=88) (actual time=7499.232..7499.264 rows=103707 loops=3)
                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 5152kB
                                                                                                                             Buffers: shared hit=5151 read=107764, temp read=107038 written=111160
                                                                                                                             I/O Timings: shared read=12792.156, temp read=420.607 write=1459.145
                                                                                                                             ->  Parallel Hash Join  (cost=303982.78..336749.49 rows=129634 width=88) (actual time=7342.930..7453.235 rows=103707 loops=3)
                                                                                                                                   Hash Cond: (("Td270e16c00"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                   Buffers: shared hit=5151 read=107764, temp read=107038 written=107520
                                                                                                                                   I/O Timings: shared read=12792.156, temp read=420.607 write=1410.156
                                                                                                                                   ->  Parallel Seq Scan on "Td270e16c00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.051..891.098 rows=590288 loops=3)
                                                                                                                                         Buffers: shared hit=399 read=10881
                                                                                                                                         I/O Timings: shared read=2523.056
                                                                                                                                   ->  Parallel Hash  (cost=300209.36..300209.36 rows=129634 width=112) (actual time=6325.740..6325.770 rows=103707 loops=3)
                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                         Buffers: shared hit=4752 read=96883, temp read=93107 written=97948
                                                                                                                                         I/O Timings: shared read=10269.100, temp read=367.014 write=1281.643
                                                                                                                                         ->  Parallel Hash Join  (cost=270845.65..300209.36 rows=129634 width=112) (actual time=6176.436..6278.718 rows=103707 loops=3)
                                                                                                                                               Hash Cond: (("T5b22144900"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                               Buffers: shared hit=4752 read=96883, temp read=93107 written=93544
                                                                                                                                               I/O Timings: shared read=10269.100, temp read=367.014 write=1227.152
                                                                                                                                               ->  Parallel Seq Scan on "T5b22144900"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.041..932.820 rows=590288 loops=3)
                                                                                                                                                     Buffers: shared hit=388 read=9185
                                                                                                                                                     I/O Timings: shared read=2644.247
                                                                                                                                               ->  Parallel Hash  (cost=267326.22..267326.22 rows=129634 width=96) (actual time=5126.984..5127.011 rows=103707 loops=3)
                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                     Buffers: shared hit=4364 read=87698, temp read=81440 written=85720
                                                                                                                                                     I/O Timings: shared read=7624.853, temp read=321.762 write=1121.527
                                                                                                                                                     ->  Parallel Hash Join  (cost=231124.51..267326.22 rows=129634 width=96) (actual time=4970.711..5082.116 rows=103707 loops=3)
                                                                                                                                                           Hash Cond: (("T5b5e0b4000"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                           Buffers: shared hit=4364 read=87698, temp read=81440 written=81824
                                                                                                                                                           I/O Timings: shared read=7624.853, temp read=321.762 write=1072.454
                                                                                                                                                           ->  Parallel Seq Scan on "T5b5e0b4000"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.072..183.271 rows=590288 loops=3)
                                                                                                                                                                 Buffers: shared hit=426 read=12596
                                                                                                                                                                 I/O Timings: shared read=380.113
                                                                                                                                                           ->  Parallel Hash  (cost=227098.09..227098.09 rows=129634 width=128) (actual time=4634.251..4634.276 rows=103707 loops=3)
                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 6688kB
                                                                                                                                                                 Buffers: shared hit=3938 read=75102, temp read=65251 written=70536
                                                                                                                                                                 I/O Timings: shared read=7244.739, temp read=259.648 write=929.514
                                                                                                                                                                 ->  Parallel Hash Join  (cost=197480.37..227098.09 rows=129634 width=128) (actual time=4476.737..4582.658 rows=103707 loops=3)
                                                                                                                                                                       Hash Cond: (("Tfa4505c500"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                       Buffers: shared hit=3938 read=75102, temp read=65251 written=65584
                                                                                                                                                                       I/O Timings: shared read=7244.739, temp read=259.648 write=868.723
                                                                                                                                                                       ->  Parallel Seq Scan on "Tfa4505c500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.048..168.610 rows=590288 loops=3)
                                                                                                                                                                             Buffers: shared hit=359 read=9214
                                                                                                                                                                             I/O Timings: shared read=368.433
                                                                                                                                                                       ->  Parallel Hash  (cost=193706.95..193706.95 rows=129634 width=112) (actual time=4199.613..4199.634 rows=103707 loops=3)
                                                                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                             Buffers: shared hit=3579 read=65888, temp read=53051 written=57756
                                                                                                                                                                             I/O Timings: shared read=6876.306, temp read=212.335 write=769.394
                                                                                                                                                                             ->  Parallel Hash Join  (cost=164343.24..193706.95 rows=129634 width=112) (actual time=4054.528..4149.832 rows=103707 loops=3)
                                                                                                                                                                                   Hash Cond: (("Tfa45022400"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                   Buffers: shared hit=3579 read=65888, temp read=53051 written=53324
                                                                                                                                                                                   I/O Timings: shared read=6876.306, temp read=212.335 write=714.122
                                                                                                                                                                                   ->  Parallel Seq Scan on "Tfa45022400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.039..160.394 rows=590288 loops=3)
                                                                                                                                                                                         Buffers: shared hit=384 read=9189
                                                                                                                                                                                         I/O Timings: shared read=341.932
                                                                                                                                                                                   ->  Parallel Hash  (cost=160823.81..160823.81 rows=129634 width=96) (actual time=3774.454..3774.472 rows=103707 loops=3)
                                                                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                         Buffers: shared hit=3195 read=56699, temp read=41383 written=45488
                                                                                                                                                                                         I/O Timings: shared read=6534.374, temp read=166.679 write=613.360
                                                                                                                                                                                         ->  Parallel Hash Join  (cost=124875.10..160823.81 rows=129634 width=96) (actual time=3618.708..3729.278 rows=103707 loops=3)
                                                                                                                                                                                               Hash Cond: (("Tedb9668900"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                               Buffers: shared hit=3195 read=56699, temp read=41383 written=41584
                                                                                                                                                                                               I/O Timings: shared read=6534.374, temp read=166.679 write=564.014
                                                                                                                                                                                               ->  Parallel Seq Scan on "Tedb9668900"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.078..786.876 rows=590288 loops=3)
                                                                                                                                                                                                     Buffers: shared hit=384 read=12638
                                                                                                                                                                                                     I/O Timings: shared read=2181.642
                                                                                                                                                                                               ->  Parallel Hash  (cost=121101.68..121101.68 rows=129634 width=112) (actual time=2667.910..2667.925 rows=103707 loops=3)
                                                                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                                                     Buffers: shared hit=2811 read=44061, temp read=25728 written=30288
                                                                                                                                                                                                     I/O Timings: shared read=4352.732, temp read=103.485 write=408.705
                                                                                                                                                                                                     ->  Parallel Hash Join  (cost=91737.97..121101.68 rows=129634 width=112) (actual time=2513.044..2618.623 rows=103707 loops=3)
                                                                                                                                                                                                           Hash Cond: (("Tfa4502a500"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                                           Buffers: shared hit=2811 read=44061, temp read=25728 written=25868
                                                                                                                                                                                                           I/O Timings: shared read=4352.732, temp read=103.485 write=353.338
                                                                                                                                                                                                           ->  Parallel Seq Scan on "Tfa4502a500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.048..422.384 rows=590288 loops=3)
                                                                                                                                                                                                                 Buffers: shared hit=288 read=9285
                                                                                                                                                                                                                 I/O Timings: shared read=1120.079
                                                                                                                                                                                                           ->  Parallel Hash  (cost=88218.54..88218.54 rows=129634 width=96) (actual time=1973.545..1973.557 rows=103707 loops=3)
                                                                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                                                 Buffers: shared hit=2523 read=34776, temp read=14057 written=18044
                                                                                                                                                                                                                 I/O Timings: shared read=3232.653, temp read=55.985 write=243.996
                                                                                                                                                                                                                 ->  Parallel Hash Join  (cost=53029.83..88218.54 rows=129634 width=96) (actual time=1828.457..1928.171 rows=103707 loops=3)
                                                                                                                                                                                                                       Hash Cond: (("Tc9e51c8100"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                                                                       Buffers: shared hit=2523 read=34776, temp read=14057 written=14132
                                                                                                                                                                                                                       I/O Timings: shared read=3232.653, temp read=55.985 write=193.215
                                                                                                                                                                                                                       ->  Parallel Seq Scan on "Tc9e51c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.064..670.577 rows=590288 loops=3)
                                                                                                                                                                                                                             Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                             I/O Timings: shared read=1841.269
                                                                                                                                                                                                                       ->  Parallel Hash  (cost=50016.41..50016.41 rows=129634 width=64) (actual time=1000.041..1000.050 rows=103707 loops=3)
                                                                                                                                                                                                                             Buckets: 131072  Batches: 8  Memory Usage: 4736kB
                                                                                                                                                                                                                             Buffers: shared hit=2235 read=22042, temp written=2840
                                                                                                                                                                                                                             I/O Timings: shared read=1391.384, temp write=40.797
                                                                                                                                                                                                                             ->  Parallel Hash Join  (cost=26308.70..50016.41 rows=129634 width=64) (actual time=468.873..955.782 rows=103707 loops=3)
                                                                                                                                                                                                                                   Hash Cond: (("T528b9c8100"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                                                                   Buffers: shared hit=2235 read=22042
                                                                                                                                                                                                                                   I/O Timings: shared read=1391.384
                                                                                                                                                                                                                                   ->  Parallel Seq Scan on "T528b9c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.053..324.434 rows=590288 loops=3)
                                                                                                                                                                                                                                         Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                                         I/O Timings: shared read=820.736
                                                                                                                                                                                                                                   ->  Parallel Hash  (cost=24688.27..24688.27 rows=129634 width=32) (actual time=465.603..465.609 rows=103707 loops=3)
                                                                                                                                                                                                                                         Buckets: 524288  Batches: 1  Memory Usage: 23616kB
                                                                                                                                                                                                                                         Buffers: shared hit=1947 read=9308
                                                                                                                                                                                                                                         I/O Timings: shared read=570.649
                                                                                                                                                                                                                                         ->  Parallel Hash Join  (cost=5799.79..24688.27 rows=129634 width=32) (actual time=353.588..424.358 rows=103707 loops=3)
                                                                                                                                                                                                                                               Hash Cond: (("Tfa45022500"."Tfa45022500_uid")::uuid = ("Tfa45026200"."Tfa45026200_uid")::uuid)
                                                                                                                                                                                                                                               Buffers: shared hit=1947 read=9308
                                                                                                                                                                                                                                               I/O Timings: shared read=570.649
                                                                                                                                                                                                                                               ->  Parallel Seq Scan on "Tfa45022500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.044..237.822 rows=590288 loops=3)
                                                                                                                                                                                                                                                     Buffers: shared hit=265 read=9308
                                                                                                                                                                                                                                                     I/O Timings: shared read=570.649
                                                                                                                                                                                                                                               ->  Parallel Hash  (cost=3512.13..3512.13 rows=183013 width=16) (actual time=46.845..46.847 rows=103707 loops=3)
                                                                                                                                                                                                                                                     Buckets: 524288  Batches: 1  Memory Usage: 18752kB
                                                                                                                                                                                                                                                     Buffers: shared hit=1682
                                                                                                                                                                                                                                                     ->  Parallel Seq Scan on "Tfa45026200"  (cost=0.00..3512.13 rows=183013 width=16) (actual time=0.010..9.529 rows=103707 loops=3)
                                                                                                                                                                                                                                                           Buffers: shared hit=1682
                                         ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=45.732..45.733 rows=99904 loops=3)
                                               Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                               Buffers: shared hit=1621
                                               ->  Parallel Seq Scan on "Tfa45062900"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.015..9.621 rows=99904 loops=3)
                                                     Buffers: shared hit=1621
                                   ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=1405.950..1405.951 rows=99904 loops=3)
                                         Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                         Buffers: shared hit=1621
                                         ->  Parallel Seq Scan on "T2448628400"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.007..9.456 rows=99904 loops=3)
                                               Buffers: shared hit=1621
   ->  CTE Scan on patient_hospitalisation_debut_fin  (cost=0.00..6860.08 rows=343004 width=40) (actual time=13558.387..13601.064 rows=311122 loops=1)
         Buffers: shared hit=3254 read=63626, temp read=78237 written=77420
         I/O Timings: shared read=5596.649, temp read=307.707 write=985.051
   ->  Hash  (cost=18205415.00..18205415.00 rows=200 width=48) (actual time=2204.688..2204.694 rows=166997 loops=1)
         Buckets: 262144 (originally 1024)  Batches: 2 (originally 1)  Memory Usage: 6617kB
         Buffers: temp read=14549 written=16772
         I/O Timings: temp read=53.669 write=168.586
         ->  Subquery Scan on nombre_semaines  (cost=18205409.50..18205415.00 rows=200 width=48) (actual time=1642.068..2161.398 rows=166997 loops=1)
               Buffers: temp read=14549 written=16367
               I/O Timings: temp read=53.669 write=163.593
               ->  HashAggregate  (cost=18205409.50..18205413.00 rows=200 width=48) (actual time=1642.058..2144.047 rows=166997 loops=1)
                     Group Key: curr.hospitalisation
                     Batches: 21  Memory Usage: 8265kB  Disk Usage: 36648kB
                     Buffers: temp read=14549 written=16367
                     I/O Timings: temp read=53.669 write=163.593
                     ->  Merge Join  (cost=96723.78..11864470.71 rows=195105809 width=40) (actual time=673.717..1162.320 rows=703895 loops=1)
                           Merge Cond: ((curr.patient)::uuid = (prev.patient)::uuid)
                           Join Filter: (((curr.hospitalisation)::uuid <> (prev.hospitalisation)::uuid) AND ((prev.date_admission_hospitalisation)::timestamp without time zone <= (curr.date_admission_hospitalisation)::timestamp without time zone))
                           Rows Removed by Join Filter: 1015015
                           Buffers: temp read=7921 written=6330
                           I/O Timings: temp read=28.097 write=74.457
                           ->  Sort  (cost=47775.64..48633.15 rows=343004 width=40) (actual time=528.331..570.971 rows=311122 loops=1)
                                 Sort Key: curr.patient
                                 Sort Method: external merge  Disk: 15240kB
                                 Buffers: temp read=3509 written=4113
                                 I/O Timings: temp read=12.142 write=48.611
                                 ->  CTE Scan on patient_hospitalisation_debut_fin curr  (cost=0.00..6860.08 rows=343004 width=40) (actual time=0.027..433.349 rows=311122 loops=1)
                                       Buffers: temp read=1604 written=2202
                                       I/O Timings: temp read=5.478 write=26.853
                           ->  Materialize  (cost=48948.14..50663.16 rows=343004 width=48) (actual time=145.306..315.594 rows=1718910 loops=1)
                                 Buffers: temp read=4412 written=2217
                                 I/O Timings: temp read=15.955 write=25.846
                                 ->  Sort  (cost=48948.14..49805.65 rows=343004 width=48) (actual time=145.301..189.234 rows=311122 loops=1)
                                       Sort Key: prev.patient
                                       Sort Method: external merge  Disk: 17672kB
                                       Buffers: temp read=4412 written=2217
                                       I/O Timings: temp read=15.955 write=25.846
                                       ->  CTE Scan on patient_hospitalisation_debut_fin prev  (cost=0.00..6860.08 rows=343004 width=48) (actual time=0.034..48.498 rows=311122 loops=1)
                                             Buffers: temp read=2203 written=1
                                             I/O Timings: temp read=7.855 write=0.022
 Settings: search_path = 'test_mimic'
 Planning:
   Buffers: shared hit=1113
 Planning Time: 28.539 ms
 JIT:
   Functions: 524
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 25.879 ms, Inlining 268.282 ms, Optimization 2117.203 ms, Emission 1452.491 ms, Total 3863.855 ms
 Execution Time: 16281.093 ms
(278 rows)

> Loop number : 5
SET
SET
SET
SET
SET
SET
SET
SET
SET
                                                                                                                                                                                      QUERY PLAN                                                                                                                                                                                      
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Hash Left Join  (cost=18887920.23..18895699.77 rows=343004 width=72) (actual time=13508.071..13977.194 rows=311122 loops=1)
   Hash Cond: ((patient_hospitalisation_debut_fin.hospitalisation)::uuid = (nombre_semaines.hospitalisation)::uuid)
   Buffers: shared hit=11479 read=189624, temp read=245588 written=247981
   I/O Timings: shared read=9884.242, temp read=952.557 write=3148.475
   CTE patient_hospitalisation_debut_fin
     ->  Unique  (cost=637337.74..682502.73 rows=343004 width=48) (actual time=11291.352..11932.155 rows=311122 loops=1)
           Buffers: shared hit=11479 read=189624, temp read=228741 written=229915
           I/O Timings: shared read=9884.242, temp read=887.818 write=2962.511
           ->  Gather Merge  (cost=637337.74..679072.69 rows=343004 width=48) (actual time=11291.351..11863.212 rows=592379 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 Buffers: shared hit=11479 read=189624, temp read=228741 written=229915
                 I/O Timings: shared read=9884.242, temp read=887.818 write=2962.511
                 ->  Unique  (cost=636337.72..638481.49 rows=171502 width=48) (actual time=11259.424..11368.554 rows=197460 loops=3)
                       Buffers: shared hit=11479 read=189624, temp read=228741 written=229915
                       I/O Timings: shared read=9884.242, temp read=887.818 write=2962.511
                       ->  Sort  (cost=636337.72..636766.47 rows=171502 width=48) (actual time=11259.422..11325.050 rows=294355 loops=3)
                             Sort Key: "T2448628400"."T2448628400_uid", "Tfa45026200"."Tfa45026200_uid", "Tcee93e6b00"."Tcee93e6b00_Ontorel-Core_0000004", "Td270e16c00"."Td270e16c00_Ontorel-Core_0000004"
                             Sort Method: external merge  Disk: 16664kB
                             Buffers: shared hit=11479 read=189624, temp read=228741 written=229915
                             I/O Timings: shared read=9884.242, temp read=887.818 write=2962.511
                             Worker 0:  Sort Method: external merge  Disk: 16800kB
                             Worker 1:  Sort Method: external merge  Disk: 16680kB
                             ->  Parallel Hash Join  (cost=577178.76..616149.45 rows=171502 width=48) (actual time=10625.910..11084.130 rows=294355 loops=3)
                                   Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("T2448628400"."T2448628400_uid")::uuid)
                                   Buffers: shared hit=11351 read=189624, temp read=222473 written=223628
                                   I/O Timings: shared read=9884.242, temp read=866.352 write=2886.988
                                   ->  Parallel Hash Join  (cost=571590.98..610111.47 rows=171502 width=64) (actual time=9163.629..9503.424 rows=294355 loops=3)
                                         Hash Cond: (("Tc68c9cba00"."Tfa45062900_uid")::uuid = ("Tfa45062900"."Tfa45062900_uid")::uuid)
                                         Buffers: shared hit=9714 read=189624, temp read=222473 written=223628
                                         I/O Timings: shared read=9884.242, temp read=866.352 write=2886.988
                                         ->  Parallel Hash Join  (cost=566003.21..604073.49 rows=171502 width=48) (actual time=9116.941..9338.574 rows=294355 loops=3)
                                               Hash Cond: (("Tc68c9cba00"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                               Buffers: shared hit=8093 read=189624, temp read=222473 written=223628
                                               I/O Timings: shared read=9884.242, temp read=866.352 write=2886.988
                                               ->  Parallel Seq Scan on "Tc68c9cba00"  (cost=0.00..21784.05 rows=787905 width=32) (actual time=0.068..435.275 rows=630324 loops=3)
                                                     Buffers: shared hit=347 read=13558
                                                     I/O Timings: shared read=1108.910
                                               ->  Parallel Hash  (cost=562016.44..562016.44 rows=171502 width=64) (actual time=8500.223..8500.359 rows=294355 loops=3)
                                                     Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 6272kB
                                                     Buffers: shared hit=7746 read=176066, temp read=201940 written=211524
                                                     I/O Timings: shared read=8775.331, temp read=785.377 write=2718.575
                                                     ->  Parallel Hash Join  (cost=531042.15..562016.44 rows=171502 width=64) (actual time=8185.383..8362.179 rows=294355 loops=3)
                                                           Hash Cond: (("Tfa45020700"."Tfa45020700_uid")::uuid = ("T69af2e7200"."Tfa45020700_uid")::uuid)
                                                           Buffers: shared hit=7746 read=176066, temp read=198420 written=199460
                                                           I/O Timings: shared read=8775.331, temp read=773.076 write=2570.056
                                                           ->  Parallel Seq Scan on "Tfa45020700"  (cost=0.00..18101.05 rows=787905 width=16) (actual time=0.075..229.096 rows=630324 loops=3)
                                                                 Buffers: shared hit=379 read=9843
                                                                 I/O Timings: shared read=531.689
                                                           ->  Parallel Hash  (cost=527390.38..527390.38 rows=171502 width=48) (actual time=7828.853..7828.985 rows=294355 loops=3)
                                                                 Buckets: 131072 (originally 131072)  Batches: 16 (originally 8)  Memory Usage: 5408kB
                                                                 Buffers: shared hit=7367 read=166223, temp read=183177 written=191044
                                                                 I/O Timings: shared read=8243.642, temp read=712.785 write=2458.332
                                                                 ->  Parallel Hash Join  (cost=481032.46..527390.38 rows=171502 width=48) (actual time=7509.059..7671.203 rows=294355 loops=3)
                                                                       Hash Cond: (("T69af2e7200"."Tfa45022500_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                       Buffers: shared hit=7367 read=166223, temp read=177120 written=177980
                                                                       I/O Timings: shared read=8243.642, temp read=691.421 write=2291.333
                                                                       ->  Parallel Seq Scan on "T69af2e7200"  (cost=0.00..26988.69 rows=976169 width=32) (actual time=0.046..415.409 rows=780935 loops=3)
                                                                             Buffers: shared hit=387 read=16840
                                                                             I/O Timings: shared read=1049.519
                                                                       ->  Parallel Hash  (cost=477766.04..477766.04 rows=129634 width=80) (actual time=6914.646..6914.776 rows=103707 loops=3)
                                                                             Buckets: 131072  Batches: 8  Memory Usage: 5344kB
                                                                             Buffers: shared hit=6980 read=149383, temp read=158894 written=163052
                                                                             I/O Timings: shared read=7194.124, temp read=617.763 write=2093.985
                                                                             ->  Parallel Hash Join  (cost=445126.33..477766.04 rows=129634 width=80) (actual time=6768.571..6870.058 rows=103707 loops=3)
                                                                                   Hash Cond: (("Tcee93e6b00"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                   Buffers: shared hit=6980 read=149383, temp read=158894 written=159672
                                                                                   I/O Timings: shared read=7194.124, temp read=617.763 write=2049.861
                                                                                   ->  Parallel Seq Scan on "Tcee93e6b00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.041..243.301 rows=590288 loops=3)
                                                                                         Buffers: shared hit=463 read=10817
                                                                                         I/O Timings: shared read=578.387
                                                                                   ->  Parallel Hash  (cost=441479.90..441479.90 rows=129634 width=104) (actual time=6388.738..6388.865 rows=103707 loops=3)
                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5728kB
                                                                                         Buffers: shared hit=6517 read=138566, temp read=145227 written=150100
                                                                                         I/O Timings: shared read=6615.736, temp read=564.196 write=1921.273
                                                                                         ->  Parallel Hash Join  (cost=412242.19..441479.90 rows=129634 width=104) (actual time=6221.311..6336.034 rows=103707 loops=3)
                                                                                               Hash Cond: (("T5b22144800"."T5b22144800_uid")::uuid = ("Tbe02328700"."T5b22144800_uid")::uuid)
                                                                                               Buffers: shared hit=6517 read=138566, temp read=145227 written=145952
                                                                                               I/O Timings: shared read=6615.736, temp read=564.196 write=1863.008
                                                                                               ->  Parallel Seq Scan on "T5b22144800"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.047..224.014 rows=590288 loops=3)
                                                                                                     Buffers: shared hit=431 read=9142
                                                                                                     I/O Timings: shared read=521.025
                                                                                               ->  Parallel Hash  (cost=408848.76..408848.76 rows=129634 width=88) (actual time=5865.854..5865.979 rows=103707 loops=3)
                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5120kB
                                                                                                     Buffers: shared hit=6086 read=129424, temp read=133823 written=138128
                                                                                                     I/O Timings: shared read=6094.711, temp read=516.676 write=1758.680
                                                                                                     ->  Parallel Hash Join  (cost=373027.05..408848.76 rows=129634 width=88) (actual time=5707.253..5820.157 rows=103707 loops=3)
                                                                                                           Hash Cond: (("Tbe02328700"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                           Buffers: shared hit=6086 read=129424, temp read=133823 written=134484
                                                                                                           I/O Timings: shared read=6094.711, temp read=516.676 write=1710.690
                                                                                                           ->  Parallel Seq Scan on "Tbe02328700"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.068..259.654 rows=590288 loops=3)
                                                                                                                 Buffers: shared hit=441 read=12581
                                                                                                                 I/O Timings: shared read=601.902
                                                                                                           ->  Parallel Hash  (cost=369380.63..369380.63 rows=129634 width=104) (actual time=5287.002..5287.123 rows=103707 loops=3)
                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5760kB
                                                                                                                 Buffers: shared hit=5645 read=116843, temp read=118436 written=123184
                                                                                                                 I/O Timings: shared read=5492.809, temp read=456.895 write=1561.439
                                                                                                                 ->  Parallel Hash Join  (cost=340142.92..369380.63 rows=129634 width=104) (actual time=5134.837..5240.218 rows=103707 loops=3)
                                                                                                                       Hash Cond: (("Tfa4502a400"."Tfa4502a400_uid")::uuid = ("T5b5e0b4000"."Tfa4502a400_uid")::uuid)
                                                                                                                       Buffers: shared hit=5645 read=116843, temp read=118436 written=119036
                                                                                                                       I/O Timings: shared read=5492.809, temp read=456.895 write=1510.059
                                                                                                                       ->  Parallel Seq Scan on "Tfa4502a400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.044..108.235 rows=590288 loops=3)
                                                                                                                             Buffers: shared hit=442 read=9131
                                                                                                                             I/O Timings: shared read=183.460
                                                                                                                       ->  Parallel Hash  (cost=336749.49..336749.49 rows=129634 width=88) (actual time=4912.215..4912.335 rows=103707 loops=3)
                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 5152kB
                                                                                                                             Buffers: shared hit=5203 read=107712, temp read=107035 written=111204
                                                                                                                             I/O Timings: shared read=5309.349, temp read=412.965 write=1407.604
                                                                                                                             ->  Parallel Hash Join  (cost=303982.78..336749.49 rows=129634 width=88) (actual time=4760.076..4867.840 rows=103707 loops=3)
                                                                                                                                   Hash Cond: (("Td270e16c00"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                   Buffers: shared hit=5203 read=107712, temp read=107035 written=107560
                                                                                                                                   I/O Timings: shared read=5309.349, temp read=412.965 write=1361.607
                                                                                                                                   ->  Parallel Seq Scan on "Td270e16c00"  (cost=0.00..18658.60 rows=737860 width=24) (actual time=0.053..444.475 rows=590288 loops=3)
                                                                                                                                         Buffers: shared hit=418 read=10862
                                                                                                                                         I/O Timings: shared read=1194.159
                                                                                                                                   ->  Parallel Hash  (cost=300209.36..300209.36 rows=129634 width=112) (actual time=4196.465..4196.581 rows=103707 loops=3)
                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                         Buffers: shared hit=4785 read=96850, temp read=93107 written=97992
                                                                                                                                         I/O Timings: shared read=4115.190, temp read=359.388 write=1240.177
                                                                                                                                         ->  Parallel Hash Join  (cost=270845.65..300209.36 rows=129634 width=112) (actual time=4046.395..4148.957 rows=103707 loops=3)
                                                                                                                                               Hash Cond: (("T5b22144900"."T5b22144900_uid")::uuid = ("Tedb9668900"."T5b22144900_uid")::uuid)
                                                                                                                                               Buffers: shared hit=4785 read=96850, temp read=93107 written=93580
                                                                                                                                               I/O Timings: shared read=4115.190, temp read=359.388 write=1185.951
                                                                                                                                               ->  Parallel Seq Scan on "T5b22144900"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.051..312.640 rows=590288 loops=3)
                                                                                                                                                     Buffers: shared hit=416 read=9157
                                                                                                                                                     I/O Timings: shared read=792.333
                                                                                                                                               ->  Parallel Hash  (cost=267326.22..267326.22 rows=129634 width=96) (actual time=3624.109..3624.223 rows=103707 loops=3)
                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 5472kB
                                                                                                                                                     Buffers: shared hit=4369 read=87693, temp read=81441 written=85740
                                                                                                                                                     I/O Timings: shared read=3322.857, temp read=314.271 write=1086.634
                                                                                                                                                     ->  Parallel Hash Join  (cost=231124.51..267326.22 rows=129634 width=96) (actual time=3464.224..3577.929 rows=103707 loops=3)
                                                                                                                                                           Hash Cond: (("T5b5e0b4000"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                           Buffers: shared hit=4369 read=87693, temp read=81441 written=81836
                                                                                                                                                           I/O Timings: shared read=3322.857, temp read=314.271 write=1034.318
                                                                                                                                                           ->  Parallel Seq Scan on "T5b5e0b4000"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.067..93.552 rows=590288 loops=3)
                                                                                                                                                                 Buffers: shared hit=401 read=12621
                                                                                                                                                                 I/O Timings: shared read=104.385
                                                                                                                                                           ->  Parallel Hash  (cost=227098.09..227098.09 rows=129634 width=128) (actual time=3210.335..3210.446 rows=103707 loops=3)
                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 6688kB
                                                                                                                                                                 Buffers: shared hit=3968 read=75072, temp read=65251 written=70548
                                                                                                                                                                 I/O Timings: shared read=3218.472, temp read=252.645 write=887.274
                                                                                                                                                                 ->  Parallel Hash Join  (cost=197480.37..227098.09 rows=129634 width=128) (actual time=3051.893..3158.564 rows=103707 loops=3)
                                                                                                                                                                       Hash Cond: (("Tfa4505c500"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                       Buffers: shared hit=3968 read=75072, temp read=65251 written=65592
                                                                                                                                                                       I/O Timings: shared read=3218.472, temp read=252.645 write=827.045
                                                                                                                                                                       ->  Parallel Seq Scan on "Tfa4505c500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.050..71.195 rows=590288 loops=3)
                                                                                                                                                                             Buffers: shared hit=384 read=9189
                                                                                                                                                                             I/O Timings: shared read=77.380
                                                                                                                                                                       ->  Parallel Hash  (cost=193706.95..193706.95 rows=129634 width=112) (actual time=2872.995..2873.102 rows=103707 loops=3)
                                                                                                                                                                             Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                             Buffers: shared hit=3584 read=65883, temp read=53050 written=57752
                                                                                                                                                                             I/O Timings: shared read=3141.092, temp read=206.110 write=730.889
                                                                                                                                                                             ->  Parallel Hash Join  (cost=164343.24..193706.95 rows=129634 width=112) (actual time=2727.953..2823.374 rows=103707 loops=3)
                                                                                                                                                                                   Hash Cond: (("Tfa45022400"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                   Buffers: shared hit=3584 read=65883, temp read=53050 written=53316
                                                                                                                                                                                   I/O Timings: shared read=3141.092, temp read=206.110 write=675.634
                                                                                                                                                                                   ->  Parallel Seq Scan on "Tfa45022400"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.054..108.305 rows=590288 loops=3)
                                                                                                                                                                                         Buffers: shared hit=384 read=9189
                                                                                                                                                                                         I/O Timings: shared read=186.854
                                                                                                                                                                                   ->  Parallel Hash  (cost=160823.81..160823.81 rows=129634 width=96) (actual time=2497.017..2497.034 rows=103707 loops=3)
                                                                                                                                                                                         Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                         Buffers: shared hit=3200 read=56694, temp read=41387 written=45484
                                                                                                                                                                                         I/O Timings: shared read=2954.238, temp read=161.179 write=572.789
                                                                                                                                                                                         ->  Parallel Hash Join  (cost=124875.10..160823.81 rows=129634 width=96) (actual time=2344.032..2452.620 rows=103707 loops=3)
                                                                                                                                                                                               Hash Cond: (("Tedb9668900"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                               Buffers: shared hit=3200 read=56694, temp read=41387 written=41576
                                                                                                                                                                                               I/O Timings: shared read=2954.238, temp read=161.179 write=524.186
                                                                                                                                                                                               ->  Parallel Seq Scan on "Tedb9668900"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.068..298.502 rows=590288 loops=3)
                                                                                                                                                                                                     Buffers: shared hit=384 read=12638
                                                                                                                                                                                                     I/O Timings: shared read=728.009
                                                                                                                                                                                               ->  Parallel Hash  (cost=121101.68..121101.68 rows=129634 width=112) (actual time=1892.089..1892.103 rows=103707 loops=3)
                                                                                                                                                                                                     Buckets: 65536  Batches: 8  Memory Usage: 6048kB
                                                                                                                                                                                                     Buffers: shared hit=2816 read=44056, temp read=25732 written=30284
                                                                                                                                                                                                     I/O Timings: shared read=2226.229, temp read=101.233 write=382.562
                                                                                                                                                                                                     ->  Parallel Hash Join  (cost=91737.97..121101.68 rows=129634 width=112) (actual time=1742.196..1844.303 rows=103707 loops=3)
                                                                                                                                                                                                           Hash Cond: (("Tfa4502a500"."Tfa4502a500_uid")::uuid = ("Tc9e51c8100"."Tfa4502a500_uid")::uuid)
                                                                                                                                                                                                           Buffers: shared hit=2816 read=44056, temp read=25732 written=25868
                                                                                                                                                                                                           I/O Timings: shared read=2226.229, temp read=101.233 write=328.715
                                                                                                                                                                                                           ->  Parallel Seq Scan on "Tfa4502a500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.041..181.546 rows=590288 loops=3)
                                                                                                                                                                                                                 Buffers: shared hit=288 read=9285
                                                                                                                                                                                                                 I/O Timings: shared read=399.429
                                                                                                                                                                                                           ->  Parallel Hash  (cost=88218.54..88218.54 rows=129634 width=96) (actual time=1451.998..1452.009 rows=103707 loops=3)
                                                                                                                                                                                                                 Buckets: 65536  Batches: 8  Memory Usage: 5440kB
                                                                                                                                                                                                                 Buffers: shared hit=2528 read=34771, temp read=14058 written=18040
                                                                                                                                                                                                                 I/O Timings: shared read=1826.801, temp read=55.573 write=230.679
                                                                                                                                                                                                                 ->  Parallel Hash Join  (cost=53029.83..88218.54 rows=129634 width=96) (actual time=1309.623..1407.268 rows=103707 loops=3)
                                                                                                                                                                                                                       Hash Cond: (("Tc9e51c8100"."Tfa4505c500_uid")::uuid = ("T528b9c8100"."Tfa4505c500_uid")::uuid)
                                                                                                                                                                                                                       Buffers: shared hit=2528 read=34771, temp read=14058 written=14136
                                                                                                                                                                                                                       I/O Timings: shared read=1826.801, temp read=55.573 write=182.393
                                                                                                                                                                                                                       ->  Parallel Seq Scan on "Tc9e51c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.094..520.614 rows=590288 loops=3)
                                                                                                                                                                                                                             Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                             I/O Timings: shared read=1397.145
                                                                                                                                                                                                                       ->  Parallel Hash  (cost=50016.41..50016.41 rows=129634 width=64) (actual time=636.383..636.391 rows=103707 loops=3)
                                                                                                                                                                                                                             Buckets: 131072  Batches: 8  Memory Usage: 4704kB
                                                                                                                                                                                                                             Buffers: shared hit=2240 read=22037, temp written=2840
                                                                                                                                                                                                                             I/O Timings: shared read=429.656, temp write=36.542
                                                                                                                                                                                                                             ->  Parallel Hash Join  (cost=26308.70..50016.41 rows=129634 width=64) (actual time=332.300..597.272 rows=103707 loops=3)
                                                                                                                                                                                                                                   Hash Cond: (("T528b9c8100"."Tfa45022400_uid")::uuid = ("Tfa45022500"."Tfa45022500_uid")::uuid)
                                                                                                                                                                                                                                   Buffers: shared hit=2240 read=22037
                                                                                                                                                                                                                                   I/O Timings: shared read=429.656
                                                                                                                                                                                                                                   ->  Parallel Seq Scan on "T528b9c8100"  (cost=0.00..20400.60 rows=737860 width=32) (actual time=0.057..122.538 rows=590288 loops=3)
                                                                                                                                                                                                                                         Buffers: shared hit=288 read=12734
                                                                                                                                                                                                                                         I/O Timings: shared read=223.727
                                                                                                                                                                                                                                   ->  Parallel Hash  (cost=24688.27..24688.27 rows=129634 width=32) (actual time=329.027..329.032 rows=103707 loops=3)
                                                                                                                                                                                                                                         Buckets: 524288  Batches: 1  Memory Usage: 23616kB
                                                                                                                                                                                                                                         Buffers: shared hit=1952 read=9303
                                                                                                                                                                                                                                         I/O Timings: shared read=205.929
                                                                                                                                                                                                                                         ->  Parallel Hash Join  (cost=5799.79..24688.27 rows=129634 width=32) (actual time=234.005..289.273 rows=103707 loops=3)
                                                                                                                                                                                                                                               Hash Cond: (("Tfa45022500"."Tfa45022500_uid")::uuid = ("Tfa45026200"."Tfa45026200_uid")::uuid)
                                                                                                                                                                                                                                               Buffers: shared hit=1952 read=9303
                                                                                                                                                                                                                                               I/O Timings: shared read=205.929
                                                                                                                                                                                                                                               ->  Parallel Seq Scan on "Tfa45022500"  (cost=0.00..16951.60 rows=737860 width=16) (actual time=0.049..114.804 rows=590288 loops=3)
                                                                                                                                                                                                                                                     Buffers: shared hit=270 read=9303
                                                                                                                                                                                                                                                     I/O Timings: shared read=205.929
                                                                                                                                                                                                                                               ->  Parallel Hash  (cost=3512.13..3512.13 rows=183013 width=16) (actual time=46.564..46.565 rows=103707 loops=3)
                                                                                                                                                                                                                                                     Buckets: 524288  Batches: 1  Memory Usage: 18752kB
                                                                                                                                                                                                                                                     Buffers: shared hit=1682
                                                                                                                                                                                                                                                     ->  Parallel Seq Scan on "Tfa45026200"  (cost=0.00..3512.13 rows=183013 width=16) (actual time=0.010..9.260 rows=103707 loops=3)
                                                                                                                                                                                                                                                           Buffers: shared hit=1682
                                         ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=45.549..45.550 rows=99904 loops=3)
                                               Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                               Buffers: shared hit=1621
                                               ->  Parallel Seq Scan on "Tfa45062900"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.015..9.627 rows=99904 loops=3)
                                                     Buffers: shared hit=1621
                                   ->  Parallel Hash  (cost=3384.01..3384.01 rows=176301 width=16) (actual time=1460.408..1460.409 rows=99904 loops=3)
                                         Buckets: 524288  Batches: 1  Memory Usage: 18208kB
                                         Buffers: shared hit=1621
                                         ->  Parallel Seq Scan on "T2448628400"  (cost=0.00..3384.01 rows=176301 width=16) (actual time=0.008..9.404 rows=99904 loops=3)
                                               Buffers: shared hit=1621
   ->  CTE Scan on patient_hospitalisation_debut_fin  (cost=0.00..6860.08 rows=343004 width=40) (actual time=11291.356..11334.267 rows=311122 loops=1)
         Buffers: shared hit=3289 read=63391, temp read=78258 written=77397
         I/O Timings: shared read=3253.550, temp read=304.181 write=992.204
   ->  Hash  (cost=18205415.00..18205415.00 rows=200 width=48) (actual time=2216.654..2216.662 rows=166997 loops=1)
         Buckets: 262144 (originally 1024)  Batches: 2 (originally 1)  Memory Usage: 6617kB
         Buffers: temp read=14538 written=16772
         I/O Timings: temp read=53.962 write=170.222
         ->  Subquery Scan on nombre_semaines  (cost=18205409.50..18205415.00 rows=200 width=48) (actual time=1656.181..2174.182 rows=166997 loops=1)
               Buffers: temp read=14538 written=16367
               I/O Timings: temp read=53.962 write=165.105
               ->  HashAggregate  (cost=18205409.50..18205413.00 rows=200 width=48) (actual time=1656.170..2157.513 rows=166997 loops=1)
                     Group Key: curr.hospitalisation
                     Batches: 21  Memory Usage: 8265kB  Disk Usage: 36648kB
                     Buffers: temp read=14538 written=16367
                     I/O Timings: temp read=53.962 write=165.105
                     ->  Merge Join  (cost=96723.78..11864470.71 rows=195105809 width=40) (actual time=669.179..1168.865 rows=703895 loops=1)
                           Merge Cond: ((curr.patient)::uuid = (prev.patient)::uuid)
                           Join Filter: (((curr.hospitalisation)::uuid <> (prev.hospitalisation)::uuid) AND ((prev.date_admission_hospitalisation)::timestamp without time zone <= (curr.date_admission_hospitalisation)::timestamp without time zone))
                           Rows Removed by Join Filter: 1015015
                           Buffers: temp read=7910 written=6330
                           I/O Timings: temp read=28.834 write=75.222
                           ->  Sort  (cost=47775.64..48633.15 rows=343004 width=40) (actual time=526.082..570.488 rows=311122 loops=1)
                                 Sort Key: curr.patient
                                 Sort Method: external merge  Disk: 15240kB
                                 Buffers: temp read=3498 written=4113
                                 I/O Timings: temp read=12.552 write=49.391
                                 ->  CTE Scan on patient_hospitalisation_debut_fin curr  (cost=0.00..6860.08 rows=343004 width=40) (actual time=0.028..433.914 rows=311122 loops=1)
                                       Buffers: temp read=1593 written=2202
                                       I/O Timings: temp read=5.490 write=27.007
                           ->  Materialize  (cost=48948.14..50663.16 rows=343004 width=48) (actual time=143.016..317.689 rows=1718910 loops=1)
                                 Buffers: temp read=4412 written=2217
                                 I/O Timings: temp read=16.282 write=25.831
                                 ->  Sort  (cost=48948.14..49805.65 rows=343004 width=48) (actual time=143.010..188.540 rows=311122 loops=1)
                                       Sort Key: prev.patient
                                       Sort Method: external merge  Disk: 17672kB
                                       Buffers: temp read=4412 written=2217
                                       I/O Timings: temp read=16.282 write=25.831
                                       ->  CTE Scan on patient_hospitalisation_debut_fin prev  (cost=0.00..6860.08 rows=343004 width=48) (actual time=0.038..46.877 rows=311122 loops=1)
                                             Buffers: temp read=2203 written=1
                                             I/O Timings: temp read=7.655 write=0.026
 Settings: search_path = 'test_mimic'
 Planning:
   Buffers: shared hit=1113
 Planning Time: 28.969 ms
 JIT:
   Functions: 524
   Options: Inlining true, Optimization true, Expressions true, Deforming true
   Timing: Generation 26.836 ms, Inlining 280.221 ms, Optimization 2170.928 ms, Emission 1457.380 ms, Total 3935.365 ms
 Execution Time: 14074.699 ms
(278 rows)

SET
INSERT 0 1
